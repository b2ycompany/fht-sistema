(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6428],{71705:function(e,t,s){Promise.resolve().then(s.bind(s,40756))},40756:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(57437),r=s(2265),n=s(99376),l=s(35153),i=s(46413),c=s(31623),d=s(99495),o=s(66070),u=s(62869),m=s(26110),h=s(95186),f=s(26815),x=s(73578),p=s(51817),j=s(26937),b=s(76865),g=s(55773),N=s(5978);let v=e=>{if(!e)return"N/A";let t=e.split("-");if(3!==t.length)return e;let[s,a,r]=t;return"".concat(r,"/").concat(a,"/").concat(s)},y=e=>{let{onPatientAdded:t}=e,[s,n]=(0,r.useState)(""),[o,x]=(0,r.useState)(""),[j,b]=(0,r.useState)(""),[v,y]=(0,r.useState)(""),[w,C]=(0,r.useState)(!1),{toast:S}=(0,l.pm)(),{user:k,userProfile:A}=(0,i.a)(),P=async e=>{if(e.preventDefault(),!k||!A||!A.hospitalId){S({title:"Erro de Autentica\xe7\xe3o",description:"Utilizador ou unidade n\xe3o identificada.",variant:"destructive"});return}C(!0);try{let e={name:s,cpf:o.replace(/\D/g,"")||void 0,dob:j||void 0,phone:v.replace(/\D/g,"")||void 0,unitId:A.hospitalId,createdBy:k.uid},a=await (0,c.hK)(e);S({title:"Paciente Adicionado!",description:"".concat(s," foi cadastrado com sucesso."),variant:"success"}),(0,d.B)({patientName:e.name,dob:e.dob||"N/A",patientId:a,severity:"branco"});let r={id:a,...e,name_lowercase:e.name.toLowerCase(),createdAt:N.EK.now()};t(r)}catch(e){S({title:"Erro ao Adicionar Paciente",description:e.message,variant:"destructive"})}finally{C(!1)}};return(0,a.jsxs)(m.cZ,{children:[(0,a.jsxs)(m.fK,{children:[(0,a.jsx)(m.$N,{children:"Adicionar Novo Paciente"}),(0,a.jsx)(m.Be,{children:"Preencha os dados demogr\xe1ficos do paciente."})]}),(0,a.jsxs)("form",{onSubmit:P,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"name",className:"text-right",children:"Nome*"}),(0,a.jsx)(h.I,{id:"name",value:s,onChange:e=>n(e.target.value),className:"col-span-3",required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"cpf",className:"text-right",children:"CPF"}),(0,a.jsx)(g.oc,{mask:"000.000.000-00",value:o,unmask:!1,onAccept:e=>x(e),placeholder:"000.000.000-00",className:"col-span-3 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"dob",className:"text-right",children:"Data de Nasc."}),(0,a.jsx)(h.I,{id:"dob",type:"date",value:j,onChange:e=>b(e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(f._,{htmlFor:"phone",className:"text-right",children:"Telefone"}),(0,a.jsx)(g.oc,{mask:"[(00)] 00000-0000",value:v,unmask:!1,onAccept:e=>y(e),placeholder:"(11) 99999-9999",className:"col-span-3 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),(0,a.jsxs)(m.cN,{children:[(0,a.jsx)(m.GG,{asChild:!0,children:(0,a.jsx)(u.z,{type:"button",variant:"outline",children:"Cancelar"})}),(0,a.jsxs)(u.z,{type:"submit",disabled:w||!A,children:[w&&(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar e Imprimir Pulseira"]})]})]})]})};function w(){let e=(0,n.useRouter)(),{userProfile:t,profileLoading:s}=(0,i.a)(),{toast:d}=(0,l.pm)(),[f,g]=(0,r.useState)([]),[N,w]=(0,r.useState)(!1),[C,S]=(0,r.useState)(null),[k,A]=(0,r.useState)(""),[P,_]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=async()=>{if(!t||!t.hospitalId||k.length<2){g([]);return}w(!0),S(null);try{let e=await (0,c.bS)(k,t.hospitalId);g(e)}catch(e){S(e.message),d({title:"Erro na Busca",description:e.message,variant:"destructive"})}finally{w(!1)}},s=setTimeout(()=>{e()},300);return()=>clearTimeout(s)},[k,t,d]);let R=t=>{e.push("/hospital/patients/".concat(t))};return s?(0,a.jsx)("div",{className:"flex h-32 justify-center items-center",children:(0,a.jsx)(p.Z,{className:"h-6 w-6 animate-spin"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Gest\xe3o de Pacientes"}),(0,a.jsxs)(m.Vq,{open:P,onOpenChange:_,children:[(0,a.jsx)(m.hg,{asChild:!0,children:(0,a.jsxs)(u.z,{children:[(0,a.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Adicionar Paciente"]})}),(0,a.jsx)(y,{onPatientAdded:t=>{_(!1),g(e=>[t,...e]),e.push("/hospital/patients/".concat(t.id))}})]})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsx)(o.ll,{children:"Lista de Pacientes"}),(0,a.jsx)(o.SZ,{children:"Busque por nome ou CPF (m\xednimo de 2 caracteres)."})]}),(0,a.jsxs)(o.aY,{children:[(0,a.jsx)(h.I,{placeholder:"Buscar por nome...",value:k,onChange:e=>A(e.target.value),className:"max-w-sm mb-4"}),(0,a.jsx)("div",{className:"border rounded-md",children:(0,a.jsxs)(x.iA,{children:[(0,a.jsx)(x.xD,{children:(0,a.jsxs)(x.SC,{children:[(0,a.jsx)(x.ss,{children:"Nome"}),(0,a.jsx)(x.ss,{children:"CPF"}),(0,a.jsx)(x.ss,{children:"Data de Nasc."}),(0,a.jsx)(x.ss,{children:"Contato"})]})}),(0,a.jsx)(x.RM,{children:N?(0,a.jsx)(x.SC,{children:(0,a.jsx)(x.pj,{colSpan:4,className:"h-24 text-center",children:(0,a.jsx)(p.Z,{className:"mx-auto h-6 w-6 animate-spin"})})}):C?(0,a.jsx)(x.SC,{children:(0,a.jsxs)(x.pj,{colSpan:4,className:"h-24 text-center text-red-600",children:[(0,a.jsx)(b.Z,{className:"mx-auto mb-2"}),C]})}):k.length<2?(0,a.jsx)(x.SC,{children:(0,a.jsx)(x.pj,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"Digite ao menos 2 caracteres para buscar."})}):0===f.length?(0,a.jsx)(x.SC,{children:(0,a.jsx)(x.pj,{colSpan:4,className:"h-24 text-center",children:"Nenhum paciente encontrado."})}):f.map(e=>(0,a.jsxs)(x.SC,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>R(e.id),children:[(0,a.jsx)(x.pj,{className:"font-medium",children:e.name}),(0,a.jsx)(x.pj,{children:e.cpf||"N/A"}),(0,a.jsx)(x.pj,{children:v(e.dob)}),(0,a.jsx)(x.pj,{children:e.phone||"N/A"})]},e.id))})]})})]})]})]})}},73578:function(e,t,s){"use strict";s.d(t,{RM:function(){return c},SC:function(){return d},iA:function(){return l},pj:function(){return u},ss:function(){return o},xD:function(){return i}});var a=s(57437),r=s(2265),n=s(94508);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...r})})});l.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...r})});c.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});d.displayName="TableRow";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});o.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},26937:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},90535:function(e,t,s){"use strict";s.d(t,{j:function(){return l}});var a=s(61994);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=a.W,l=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return n(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:i}=t,c=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],a=null==i?void 0:i[e];if(null===t)return null;let n=r(t)||r(a);return l[e][n]}),d=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return n(e,c,null==t?void 0:null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...i,...d}[t]):({...i,...d})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}}},function(e){e.O(0,[3609,9015,6137,9388,9733,793,7236,5065,3073,8501,2971,2117,1744],function(){return e(e.s=71705)}),_N_E=e.O()}]);