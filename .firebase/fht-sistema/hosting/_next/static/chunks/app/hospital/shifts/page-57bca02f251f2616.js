(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{7668:function(e,a,s){Promise.resolve().then(s.bind(s,30075))},30075:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ea}});var t=s(57437),r=s(2265),i=s(99376),n=s(62869),l=s(66070),o=s(12339),d=s(26110),c=s(1098),u=s(53647),m=s(26815),h=s(95186),x=s(76818),p=s(35153),f=s(35974),g=s(57054),j=s(23518),v=s(51888),N=s(94508),b=s(17293),y=s(5978),E=s(33569),w=s(49505),S=s(51817),C=s(43044),I=s(49322),D=s(69076),R=s(32489),P=s(88501),A=s(91723),O=s(83774),T=s(5005),L=s(95252),k=s(95805),_=s(33245),V=s(65690),Z=s(58896),z=s(88944),U=s(70525),G=s(99397),B=s(53121),F=s(18930),M=s(42208);let q=e=>{let{title:a,value:s,description:r,icon:i,isLoading:n}=e;return(0,t.jsxs)(l.Zb,{className:"shadow-sm hover:shadow-md transition-shadow duration-200",children:[(0,t.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.ll,{className:"text-sm font-medium text-gray-600",children:a}),(0,t.jsx)(i,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.aY,{children:[n?(0,t.jsx)("div",{className:"h-8 flex items-center",children:(0,t.jsx)(S.Z,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:(0,N.cn)("font-bold text-gray-900","text-lg md:text-xl lg:text-2xl"),children:[s," "]}),r&&!n&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground pt-1",children:r})]})]})},H=Array.from({length:48},(e,a)=>"".concat(Math.floor(a/2).toString().padStart(2,"0"),":").concat(a%2==0?"00":"30")),J=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],Y={SP:["S\xe3o Paulo","Campinas","Guarulhos","Osasco","Santo Andr\xe9","S\xe3o Bernardo do Campo","Santos","Ribeir\xe3o Preto","Sorocaba","Jundia\xed","Piracicaba","Bauru","Franca","Taubat\xe9","Limeira","Barueri","Cotia","Itapevi","Ara\xe7ariguama"],RJ:["Rio de Janeiro","S\xe3o Gon\xe7alo","Duque de Caxias","Nova Igua\xe7u","Niter\xf3i","Belford Roxo","Campos dos Goytacazes","S\xe3o Jo\xe3o de Meriti","Petr\xf3polis","Volta Redonda"],MG:["Belo Horizonte","Uberl\xe2ndia","Contagem","Juiz de Fora","Betim","Montes Claros","Ribeir\xe3o das Neves","Uberaba","Governador Valadares","Ipatinga"]},Q=Object.entries(w.ku).map(e=>{let[a,s]=e;return{value:a,label:a.split("_").map(e=>e[0].toUpperCase()+e.slice(1)).join(" "),rateExample:s}}),X=r.memo(e=>{let{message:a="Carregando dados..."}=e;return(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center text-center py-10 min-h-[150px] w-full",children:[" ",(0,t.jsx)(S.Z,{className:"h-8 w-8 animate-spin text-blue-600"})," ",(0,t.jsx)("span",{className:"ml-3 text-sm text-gray-600 mt-3",children:a})," "]})});X.displayName="LoadingState";let W=r.memo(e=>{let{message:a,actionButton:s}=e;return(0,t.jsxs)("div",{className:"text-center text-sm text-gray-500 py-10 min-h-[150px] flex flex-col items-center justify-center bg-gray-50/70 rounded-md border border-dashed border-gray-300 w-full",children:[" ",(0,t.jsx)(C.Z,{className:"w-12 h-12 text-gray-400 mb-4"})," ",(0,t.jsx)("p",{className:"font-medium text-gray-600 mb-1",children:"Nada por aqui ainda!"})," ",(0,t.jsx)("p",{className:"max-w-xs",children:a})," ",s&&(0,t.jsx)("div",{className:"mt-4",children:s})," "]})});W.displayName="EmptyState";let K=r.memo(e=>{let{message:a,onRetry:s}=e;return(0,t.jsxs)("div",{className:"text-center text-sm text-red-600 py-10 min-h-[150px] flex flex-col items-center justify-center bg-red-50/70 rounded-md border border-dashed border-red-300 w-full",children:[" ",(0,t.jsx)(I.Z,{className:"w-12 h-12 text-red-400 mb-4"})," ",(0,t.jsx)("p",{className:"font-semibold text-red-700 mb-1 text-base",children:"Oops! Algo deu errado."})," ",(0,t.jsx)("p",{className:"max-w-md text-red-600",children:a||"N\xe3o foi poss\xedvel carregar os dados."})," ",s&&(0,t.jsxs)(n.z,{variant:"destructive",size:"sm",onClick:s,className:"mt-4",children:[" ",(0,t.jsx)(D.Z,{className:"mr-2 h-4 w-4"})," Tentar Novamente "]})," "]})});K.displayName="ErrorState";let $=e=>{var a;let{onShiftSubmitted:s,initialData:i}=e,{toast:l}=(0,p.pm)(),o=!!i&&!!i.id,[I,D]=(0,r.useState)(()=>{var e;return(null==i?void 0:null===(e=i.dates)||void 0===e?void 0:e.map(e=>e.toDate()))||[]}),[V,Z]=(0,r.useState)((null==i?void 0:i.startTime)||"07:00"),[z,U]=(0,r.useState)((null==i?void 0:i.endTime)||"19:00"),[G,B]=(0,r.useState)(String((null==i?void 0:i.numberOfVacancies)||"1")),[F,M]=(0,r.useState)((null==i?void 0:i.specialtiesRequired)||[]),[q,X]=(0,r.useState)((null==i?void 0:i.state)||""),[W,K]=(0,r.useState)((null==i?void 0:i.cities)||[]),[$,ee]=(0,r.useState)((null==i?void 0:i.serviceType)||""),[ea,es]=(0,r.useState)(String((null==i?void 0:i.offeredRate)||"")),[et,er]=(0,r.useState)((null==i?void 0:i.notes)||""),[ei,en]=(0,r.useState)(!1),[el,eo]=(0,r.useState)(!1),[ed,ec]=(0,r.useState)(""),[eu,em]=(0,r.useState)(null),[eh,ex]=(0,r.useState)([]),ep=(e,a)=>{Z(e),U(a)},ef=(0,r.useCallback)(()=>{D([]),Z("07:00"),U("19:00"),B("1"),M([]),ec(""),em(null),X(""),K([]),ex([]),ee(""),es(""),er("")},[]),eg=(0,r.useCallback)((e,a)=>{e&&a&&e===a?em("In\xedcio n\xe3o pode ser igual ao t\xe9rmino."):em(null)},[]);(0,r.useEffect)(()=>{eg(V,z)},[V,z,eg]),(0,r.useEffect)(()=>{q?(ex(Y[q]||[]),i&&q===i.state||K([])):(ex([]),K([]))},[q,i]);let ej=e=>{F.includes(e)||M(a=>[...a,e]),ec(""),eo(!1)},ev=e=>{M(a=>a.filter(a=>a!==e))},eN=(0,r.useMemo)(()=>w.Gg.filter(e=>"string"==typeof e&&e.toLowerCase().includes(ed.toLowerCase())&&!F.includes(e)),[ed,F]),eb=async()=>{let e=parseFloat(ea.replace(",",".")),a=parseInt(G,10);if(0===I.length&&!o){l({title:"Datas s\xe3o obrigat\xf3rias",variant:"destructive"});return}if(eu){l({title:"Hor\xe1rio Inv\xe1lido",variant:"destructive"});return}if(!$){l({title:"Tipo de Atendimento Obrigat\xf3rio",variant:"destructive"});return}if(isNaN(e)||e<=0){l({title:"Valor Hora Inv\xe1lido",variant:"destructive"});return}if(isNaN(a)||a<=0){l({title:"N\xba de Profissionais Inv\xe1lido",variant:"destructive"});return}if(!q||0===W.length){l({title:"Localiza\xe7\xe3o Obrigat\xf3ria",description:"Selecione o estado e pelo menos uma cidade.",variant:"destructive"});return}en(!0);let t=b.I8.currentUser;if(!t){l({title:"Usu\xe1rio n\xe3o autenticado",variant:"destructive"}),en(!1);return}let r=V>z,n=et.trim();try{if(o&&(null==i?void 0:i.id)){let s={startTime:V,endTime:z,isOvernight:r,state:q,cities:W,serviceType:$,specialtiesRequired:F,offeredRate:e,numberOfVacancies:a,...n?{notes:n}:{notes:""}};await (0,E.AX)(i.id,s),l({title:"Demanda Atualizada!",variant:"default"})}else{let s=I.map(e=>y.EK.fromDate(e)),i={publishedByUID:t.uid,dates:s,startTime:V,endTime:z,isOvernight:r,state:q,cities:W,serviceType:$,specialtiesRequired:F,offeredRate:e,numberOfVacancies:a,...n&&{notes:n}};await (0,E.xf)(i),l({title:"Demanda Publicada!",variant:"default"}),o||ef()}s()}catch(e){l({title:"Erro ao ".concat(o?"Salvar":"Publicar"),description:e.message,variant:"destructive"})}finally{en(!1)}};return(0,t.jsxs)(d.cZ,{className:"sm:max-w-2xl md:max-w-3xl",children:[" ",(0,t.jsxs)(d.fK,{children:[(0,t.jsx)(d.$N,{className:"text-xl",children:o?"Editar Demanda":"Publicar Nova Demanda"}),(0,t.jsx)(d.Be,{children:o?"Altere os detalhes. Datas n\xe3o s\xe3o edit\xe1veis.":"Defina os crit\xe9rios. Uma demanda ser\xe1 criada para cada data selecionada."})]}),(0,t.jsx)(d.GG,{asChild:!0,children:(0,t.jsxs)(n.z,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",children:[(0,t.jsx)(R.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Fechar"})]})}),(0,t.jsxs)("div",{className:"grid gap-5 py-4 max-h-[70vh] overflow-y-auto px-1 pr-3 md:pr-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m._,{className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(P.Z,{}),"Data(s)*"]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:o?"Original (n\xe3o edit\xe1vel).":"Selecione."}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 items-start",children:[o?(0,t.jsx)(c.f,{mode:"single",selected:I[0],disabled:!0,footer:I[0]?(0,t.jsx)("p",{children:null===(a=I[0])||void 0===a?void 0:a.toLocaleDateString("pt-BR")}):null}):(0,t.jsx)(c.f,{mode:"multiple",selected:I,onSelect:D,disabled:{before:new Date(new Date().setHours(0,0,0,0))},footer:I.length>0?(0,t.jsxs)("p",{children:[I.length," dia(s)"]}):(0,t.jsx)("p",{children:"Nenhum dia"}),modifiers:{selected:I},modifiersStyles:{selected:{backgroundColor:"#2563eb",color:"white",borderRadius:"0.375rem"}}}),I.length>0&&!o&&(0,t.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>D([]),children:[(0,t.jsx)(R.Z,{})," Limpar"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m._,{className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(A.Z,{}),"Hor\xe1rio*"]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>ep("07:00","19:00"),children:"Diurno"}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>ep("19:00","07:00"),children:"Noturno"}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>ep("08:00","12:00"),children:"Manh\xe3"}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>ep("13:00","18:00"),children:"Tarde"}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:()=>ep("00:00","23:30"),children:"24h"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m._,{htmlFor:"sTime",children:"In\xedcio*"}),(0,t.jsxs)(u.Ph,{value:V,onValueChange:Z,children:[(0,t.jsx)(u.i4,{id:"sTime",className:(0,N.cn)(eu&&"border-red-500"),children:(0,t.jsx)(u.ki,{})}),(0,t.jsx)(u.Bw,{children:H.map(e=>(0,t.jsx)(u.Ql,{value:e,children:e},"s"+e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m._,{htmlFor:"eTime",children:"T\xe9rmino*"}),(0,t.jsxs)(u.Ph,{value:z,onValueChange:U,children:[(0,t.jsx)(u.i4,{id:"eTime",className:(0,N.cn)(eu&&"border-red-500"),children:(0,t.jsx)(u.ki,{})}),(0,t.jsx)(u.Bw,{children:H.map(e=>(0,t.jsx)(u.Ql,{value:e,children:e},"e"+e))})]})]}),eu&&(0,t.jsx)("p",{className:"text-red-600 col-span-2",children:eu})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(m._,{htmlFor:"state-m",className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(O.Z,{}),"Estado*"]}),(0,t.jsxs)(u.Ph,{value:q,onValueChange:X,children:[(0,t.jsx)(u.i4,{id:"state-m",children:(0,t.jsx)(u.ki,{placeholder:"UF..."})}),(0,t.jsx)(u.Bw,{children:J.map(e=>(0,t.jsx)(u.Ql,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m._,{htmlFor:"city-m",className:"font-semibold text-gray-800",children:"Cidades*"}),(0,t.jsx)(v.R,{selectedState:q,availableCities:eh,selectedCities:W,onConfirm:K})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(m._,{htmlFor:"serv-type-m",className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(T.Z,{}),"Tipo*"]}),(0,t.jsxs)(u.Ph,{value:$,onValueChange:ee,children:[(0,t.jsx)(u.i4,{id:"serv-type-m",children:(0,t.jsx)(u.ki,{placeholder:"Selecione..."})}),(0,t.jsx)(u.Bw,{children:Q.map(e=>(0,t.jsxs)(u.Ql,{value:e.value,children:[e.label," ",(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:["(",(0,N.xG)(e.rateExample),"/h)"]})]},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(m._,{htmlFor:"rate-m",className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(L.Z,{}),"Valor/Hora (R$)*"]}),(0,t.jsx)(h.I,{id:"rate-m",type:"number",min:"1",step:"any",placeholder:"150.00",value:ea,onChange:e=>es(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(m._,{htmlFor:"vac-m",className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(k.Z,{}),"Profissionais*"]}),(0,t.jsx)(h.I,{id:"vac-m",type:"number",min:"1",step:"1",placeholder:"1",value:G,onChange:e=>B(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m._,{className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(C.Z,{}),"Especialidades (Opcional)"]}),(0,t.jsxs)(g.J2,{open:el,onOpenChange:eo,children:[(0,t.jsx)(g.xo,{asChild:!0,children:(0,t.jsx)(n.z,{variant:"outline",className:"w-full justify-start font-normal h-9",children:F.length?F.join(", "):"Selecione..."})}),(0,t.jsx)(g.yk,{className:"w-[--radix-popover-trigger-width] p-0",children:(0,t.jsxs)(j.mY,{children:[(0,t.jsx)(j.sZ,{value:ed,onValueChange:ec}),(0,t.jsxs)(j.e8,{children:[(0,t.jsx)(j.rb,{children:"Nenhuma."}),(0,t.jsx)(j.fu,{children:eN.map(e=>(0,t.jsx)(j.di,{value:e,onSelect:()=>ej(e),children:e},e))})]})]})})]}),F.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5 mt-2 pt-2 border-t",children:F.map(e=>(0,t.jsxs)(f.C,{variant:"secondary",children:[e,(0,t.jsx)("button",{type:"button",onClick:()=>ev(e),className:"ml-1.5",children:(0,t.jsx)(R.Z,{className:"h-3 w-3"})})]},e))})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(m._,{htmlFor:"notes-m",className:"font-semibold text-gray-800 flex items-center",children:[(0,t.jsx)(_.Z,{}),"Notas (Opcional)"]}),(0,t.jsx)(x.g,{id:"notes-m",placeholder:"Detalhes adicionais...",value:et,onChange:e=>er(e.target.value)})]})]}),(0,t.jsxs)(d.cN,{className:"mt-2 pt-4 border-t bg-slate-50 -m-6 px-6 pb-4 rounded-b-lg",children:[(0,t.jsx)(d.GG,{asChild:!0,children:(0,t.jsx)(n.z,{type:"button",variant:"outline",disabled:ei,children:"Cancelar"})}),(0,t.jsxs)(n.z,{type:"button",onClick:eb,disabled:ei||0===I.length&&!o,className:"bg-blue-600 hover:bg-blue-700",children:[ei&&(0,t.jsx)(S.Z,{className:"mr-2 h-4 w-4 animate-spin"}),ei?o?"Salvando...":"Publicando...":o?"Salvar Altera\xe7\xf5es":"Publicar Demanda (".concat(I.length||0," Dia(s))")]})]})]})};$.displayName="AddShiftDialog";let ee=r.memo(e=>{var a;let s;let{shift:r,actions:i}=e,l=Q.find(e=>e.value===r.serviceType),o=(null==l?void 0:l.label)||r.serviceType,d=(e=>{switch(e){case"OPEN":return{variant:"default",className:"bg-blue-100 text-blue-800 border-blue-300"};case"FULLY_STAFFED":case"CONFIRMED":case"ACTIVE_SIGNED":case"COMPLETED":case"IN_PROGRESS":return{variant:"default",className:"bg-green-100 text-green-800 border-green-300"};case"PARTIALLY_FILLED":return{variant:"default",className:"bg-sky-100 text-sky-800 border-sky-300"};case"PENDING_MATCH_REVIEW":case"PENDING_DOCTOR_ACCEPTANCE":case"PENDING_HOSPITAL_SIGNATURE":case"PENDING_CONTRACT_SIGNATURES":return{variant:"secondary",className:"bg-yellow-100 text-yellow-800 border-yellow-300"};case"CANCELLED_BY_HOSPITAL":case"EXPIRED":return{variant:"destructive",className:""};default:return{variant:"outline",className:"bg-gray-100 text-gray-800 border-gray-300"}}})(r.status);return(0,t.jsxs)("div",{className:(0,N.cn)("flex flex-col sm:flex-row items-start sm:justify-between border rounded-lg p-4 gap-x-4 gap-y-3 transition-all duration-300 bg-white shadow-xs hover:shadow-md"),children:[" ",(0,t.jsxs)("div",{className:"flex-1 space-y-2 min-w-0",children:[" ",(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[" ",(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-gray-800",children:[" ",(0,t.jsx)(P.Z,{className:"h-4 w-4 shrink-0 text-blue-600"})," ",(0,t.jsx)("span",{suppressHydrationWarning:!0,children:(()=>{if(!r.dates||0===r.dates.length)return"Datas n\xe3o especificadas";let e=r.dates[0]instanceof y.EK?r.dates[0].toDate():null,a=e?e.toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}):"Data inv\xe1lida";return r.dates.length>1&&(a+=" (e +".concat(r.dates.length-1," outro(s) dia(s))")),a})()})," ",(0,t.jsxs)("span",{className:"text-gray-500 font-normal",children:["(",r.startTime," - ",r.endTime,")"]})," "]})," ",(0,t.jsxs)(f.C,{variant:d.variant,className:(0,N.cn)("text-xs capitalize self-start sm:self-center",d.className),children:[" ",(null==(s=r.status)?void 0:s.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()))||"Desconhecido"," "]})," "]})," ",(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-1.5 text-xs text-gray-600 mt-1 pl-1",children:[" ",(0,t.jsxs)("div",{className:"flex items-center gap-1.5 truncate",children:[(0,t.jsx)(O.Z,{className:"h-3.5 w-3.5 shrink-0 text-purple-500"}),(0,t.jsxs)("span",{children:[r.cities.join(", "),", ",r.state]})]})," ",(0,t.jsxs)("div",{className:"flex items-center gap-1.5 truncate",children:[(0,t.jsx)(T.Z,{className:"h-3.5 w-3.5 shrink-0 text-cyan-500"}),(0,t.jsx)("span",{children:o})]})," ",(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-green-600 font-medium",children:[(0,t.jsx)(L.Z,{className:"h-3.5 w-3.5 shrink-0"}),(0,t.jsxs)("span",{children:[(0,N.xG)(r.offeredRate),"/hora"]})]})," ",(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-700 font-medium",children:[(0,t.jsx)(k.Z,{className:"h-3.5 w-3.5 shrink-0"}),(0,t.jsxs)("span",{children:[null!==(a=r.numberOfVacancies)&&void 0!==a?a:1," profissional(is) por data"]})]})," "]})," ",r.specialtiesRequired&&r.specialtiesRequired.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5 pt-1.5 pl-1",children:[" ",(0,t.jsx)("span",{className:"text-xs text-gray-500 mr-1 font-medium shrink-0",children:"Especialidades:"})," ",r.specialtiesRequired.map(e=>(0,t.jsx)(f.C,{variant:"outline",className:"text-gray-700 text-[11px] px-1.5 py-0.5 font-normal border-blue-200 bg-blue-50",children:e},e))," "]})," ",r.notes&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 pt-1.5 pl-1 italic flex items-start gap-1.5",children:[" ",(0,t.jsx)(_.Z,{className:"inline h-3.5 w-3.5 mr-0.5 shrink-0 relative top-0.5"})," ",(0,t.jsx)("span",{className:"truncate",children:r.notes})," "]})," "]})," ",i&&i.length>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 shrink-0 mt-2 sm:mt-0 self-end sm:self-center",children:[" ",i.map(e=>{var a;return(0,t.jsxs)(n.z,{variant:null!==(a=e.variant)&&void 0!==a?a:"ghost",size:"icon",onClick:e.onClick,className:(0,N.cn)("h-8 w-8 p-0",e.className),"aria-label":e.label,disabled:e.disabled,title:e.disabled?"Esta vaga n\xe3o pode ser alterada.":e.label,children:[" ",(0,t.jsx)(e.icon,{className:"h-4 w-4"})," "]},e.label)})," "]})," "]})});function ea(){let{toast:e}=(0,p.pm)(),a=(0,i.useRouter)(),[s,c]=(0,r.useState)([]),[u,m]=(0,r.useState)([]),[h,x]=(0,r.useState)([]),[f,g]=(0,r.useState)([]),[j,v]=(0,r.useState)(0),[w,C]=(0,r.useState)(!0),D={isLoading:!0,error:null},[R,O]=(0,r.useState)({open:{...D},pending:{...D},confirmed:{...D},history:{...D}}),[T,L]=(0,r.useState)(!1),[_,H]=(0,r.useState)("open"),[J,Y]=(0,r.useState)(null),Q=(e,a)=>{O(s=>({...s,[e]:{...s[e],...a}}))},ea=(0,r.useCallback)(async(e,a,s)=>{Q(s,{isLoading:!0,error:null});let t=b.I8.currentUser;if(!t){Q(s,{isLoading:!1,error:"Usu\xe1rio n\xe3o autenticado."});return}try{let r=(0,y.hJ)(b.db,"shiftRequirements"),i=Array.isArray(e)?(0,y.ar)("status","in",e):(0,y.ar)("status","==",e),n=(0,y.IO)(r,(0,y.ar)("hospitalId","==",t.uid),i,(0,y.Xo)("dates","asc")),l=(await (0,y.PL)(n)).docs.map(e=>({...e.data(),id:e.id}));a(l),Q(s,{isLoading:!1})}catch(e){Q(s,{isLoading:!1,error:e.message||"Erro ao carregar demandas ".concat(s,".")})}},[]),es=(0,r.useCallback)(()=>{ea("OPEN",c,"open"),ea(["PENDING_MATCH_REVIEW","PENDING_DOCTOR_ACCEPTANCE"],m,"pending"),ea("CONFIRMED",x,"confirmed"),ea(["COMPLETED","CANCELLED_BY_HOSPITAL","EXPIRED"],g,"history"),(async()=>{try{C(!0);let e=(0,y.IO)((0,y.hJ)(b.db,"users"),(0,y.ar)("userType","==","doctor")),a=await (0,y.Yp)(e);v(a.data().count)}catch(e){console.error("Erro ao buscar contagem de m\xe9dicos:",e),v(0)}finally{C(!1)}})()},[ea]);(0,r.useEffect)(()=>{es()},[es]);let et=e=>{Y(e),L(!0)},er=()=>{Y(null),L(!0)},ei=async a=>{if(a)try{await (0,E.CW)(a),e({title:"Demanda Cancelada"}),es()}catch(a){e({title:"Erro ao Cancelar",description:a.message,variant:"destructive"})}},en=(0,r.useMemo)(()=>[...s,...u,...h,...f],[s,u,h,f]),el=(0,r.useMemo)(()=>{let e=new Date;e.setDate(e.getDate()-30);let a=en.filter(a=>a.createdAt&&a.createdAt.toDate()>e),s=["FULLY_STAFFED","CONFIRMED","ACTIVE_SIGNED","COMPLETED","IN_PROGRESS"],t=a.filter(e=>e.status&&s.includes(e.status)).length,r=a.length>0?t/a.length:0,i=[...h,...f.filter(e=>"COMPLETED"===e.status)],n=0;i.forEach(a=>{var s;if((null===(s=a.dates[0])||void 0===s?void 0:s.toDate())>e){let[e,s]=a.startTime.split(":").map(Number),[t,r]=a.endTime.split(":").map(Number),i=t+r/60-(e+s/60);(a.isOvernight||i<0)&&(i+=24),n+=i*a.offeredRate*(a.numberOfVacancies||1)*a.dates.length}});let l=a.filter(e=>s.includes(e.status)&&e.createdAt&&e.updatedAt),o=0;l.length>0&&(o=(o=l.reduce((e,a)=>e+(a.updatedAt.toDate().getTime()-a.createdAt.toDate().getTime()),0))/l.length/36e5);let d={};en.forEach(e=>{var a;null===(a=e.specialtiesRequired)||void 0===a||a.forEach(e=>{d[e]=(d[e]||0)+1})});let c=Object.keys(d).length>0?Object.keys(d).reduce((e,a)=>d[e]>d[a]?e:a):"N/A";return{fillRate:r,totalCost:n,avgFillTimeInHours:o,topSpecialty:c}},[en,h,f]);return(0,t.jsxs)("div",{className:"flex flex-col gap-6 md:gap-8 p-1",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-gray-800",children:"Painel de Gerenciamento de Plant\xf5es"}),(0,t.jsxs)("section",{"aria-labelledby":"kpi-heading",children:[" ",(0,t.jsx)("h2",{id:"kpi-heading",className:"sr-only",children:"Vis\xe3o Geral"})," ",(0,t.jsxs)("div",{className:"grid gap-3 sm:gap-4 grid-cols-2 md:grid-cols-4 lg:grid-cols-7",children:[(0,t.jsx)(q,{title:"Demandas Abertas",value:s.length,icon:I.Z,isLoading:R.open.isLoading,description:"Aguardando m\xe9dicos"}),(0,t.jsx)(q,{title:"Pendentes A\xe7\xe3o",value:u.length,icon:V.Z,isLoading:R.pending.isLoading,description:"Matches/contratos"}),(0,t.jsx)(q,{title:"Taxa Preenchim. (30d)",value:(0,N.rl)(el.fillRate),icon:Z.Z,isLoading:R.history.isLoading,description:"Efici\xeancia"}),(0,t.jsx)(q,{title:"Custo Estimado (30d)",value:(0,N.xG)(el.totalCost),icon:z.Z,isLoading:R.history.isLoading||R.confirmed.isLoading,description:"Gasto com plant\xf5es"}),(0,t.jsx)(q,{title:"Tempo M\xe9dio Preench.",value:(0,N.bx)(el.avgFillTimeInHours),icon:A.Z,isLoading:R.history.isLoading,description:"Agilidade (horas)"}),(0,t.jsx)(q,{title:"M\xe9dicos na Plataforma",value:j,icon:k.Z,isLoading:w,description:"Total cadastrados"}),(0,t.jsx)(q,{title:"Top Demanda (Espec.)",value:el.topSpecialty,icon:U.Z,isLoading:R.open.isLoading,description:"Mais requisitada"})]})," "]}),(0,t.jsxs)("section",{"aria-labelledby":"shifts-management-heading",children:[(0,t.jsx)("h2",{id:"shifts-management-heading",className:"text-xl font-semibold mb-4 mt-4 text-gray-700",children:"Gerenciamento Detalhado de Demandas"}),(0,t.jsxs)(o.mQ,{value:_,onValueChange:e=>{H(e)},className:"w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-3 mb-4 border-b pb-3",children:[(0,t.jsxs)(o.dr,{className:"grid w-full grid-cols-2 md:grid-cols-4 sm:w-auto shrink-0",children:[(0,t.jsxs)(o.SP,{value:"open",children:["Abertas ",R.open.isLoading?(0,t.jsx)(S.Z,{className:"h-3 w-3 animate-spin ml-1.5"}):"(".concat(s.length,")")]}),(0,t.jsxs)(o.SP,{value:"pending",children:["Pendentes ",R.pending.isLoading?(0,t.jsx)(S.Z,{className:"h-3 w-3 animate-spin ml-1.5"}):"(".concat(u.length,")")]}),(0,t.jsxs)(o.SP,{value:"confirmed",children:["Confirmados ",R.confirmed.isLoading?(0,t.jsx)(S.Z,{className:"h-3 w-3 animate-spin ml-1.5"}):"(".concat(h.length,")")]}),(0,t.jsxs)(o.SP,{value:"history",children:["Hist\xf3rico ",R.history.isLoading?(0,t.jsx)(S.Z,{className:"h-3 w-3 animate-spin ml-1.5"}):"(".concat(f.length,")")]})]}),(0,t.jsxs)(d.Vq,{open:T,onOpenChange:e=>{L(e),e||Y(null)},children:[(0,t.jsxs)(d.hg,{onClick:er,className:(0,N.cn)((0,n.d)({variant:"default",size:"sm"}),"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white flex items-center"),children:[(0,t.jsx)(G.Z,{className:"mr-1.5 h-4 w-4"})," Publicar Nova Demanda"]}),(0,t.jsx)($,{onShiftSubmitted:()=>{L(!1),Y(null),H("open"),es()},initialData:J},J?"edit-".concat(J.id):"new-shift")]})]}),(0,t.jsxs)(o.nU,{value:"open",children:[" ",(0,t.jsxs)(l.Zb,{children:[" ",(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Demandas em Aberto"})})," ",(0,t.jsxs)(l.aY,{children:[" ",R.open.isLoading?(0,t.jsx)(X,{}):R.open.error?(0,t.jsx)(K,{message:R.open.error,onRetry:()=>ea("OPEN",c,"open")}):0===s.length?(0,t.jsx)(W,{message:"Nenhuma demanda aberta.",actionButton:(0,t.jsx)(n.z,{size:"sm",onClick:er,className:"bg-blue-600 hover:bg-blue-700",children:"Publicar Demanda"})}):(0,t.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,t.jsx)(ee,{shift:e,actions:[{label:"Editar",icon:B.Z,onClick:()=>et(e),disabled:"OPEN"!==e.status},{label:"Cancelar",icon:F.Z,onClick:()=>ei(e.id),disabled:"OPEN"!==e.status}]},e.id))})," "]})," "]})," "]}),(0,t.jsxs)(o.nU,{value:"pending",children:[" ",(0,t.jsxs)(l.Zb,{children:[" ",(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Demandas Pendentes"})})," ",(0,t.jsxs)(l.aY,{children:[" ",R.pending.isLoading?(0,t.jsx)(X,{}):R.pending.error?(0,t.jsx)(K,{message:R.pending.error,onRetry:()=>ea(["PENDING_MATCH_REVIEW"],m,"pending")}):0===u.length?(0,t.jsx)(W,{message:"Nenhuma demanda com pend\xeancias."}):(0,t.jsx)("div",{className:"space-y-3",children:u.map(e=>(0,t.jsx)(ee,{shift:e,actions:[{label:"Ver",icon:M.Z,onClick:()=>{}}]},e.id))})," "]})," "]})," "]}),(0,t.jsxs)(o.nU,{value:"confirmed",children:[" ",(0,t.jsxs)(l.Zb,{children:[" ",(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Demandas Confirmadas"})})," ",(0,t.jsxs)(l.aY,{children:[" ",R.confirmed.isLoading?(0,t.jsx)(X,{}):R.confirmed.error?(0,t.jsx)(K,{message:R.confirmed.error,onRetry:()=>ea("CONFIRMED",x,"confirmed")}):0===h.length?(0,t.jsx)(W,{message:"Nenhuma demanda confirmada."}):(0,t.jsx)("div",{className:"space-y-3",children:h.map(e=>(0,t.jsx)(ee,{shift:e,actions:[{label:"Ir para Agenda",icon:P.Z,onClick:()=>a.push("/hospital/schedule"),className:"bg-blue-100 text-blue-700 hover:bg-blue-200"}]},e.id))})," "]})," "]})," "]}),(0,t.jsxs)(o.nU,{value:"history",children:[" ",(0,t.jsxs)(l.Zb,{children:[" ",(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{children:"Hist\xf3rico de Demandas"})})," ",(0,t.jsxs)(l.aY,{children:[" ",R.history.isLoading?(0,t.jsx)(X,{}):R.history.error?(0,t.jsx)(K,{message:R.history.error,onRetry:()=>ea(["COMPLETED"],g,"history")}):0===f.length?(0,t.jsx)(W,{message:"Nenhum hist\xf3rico."}):(0,t.jsx)("div",{className:"space-y-3",children:f.map(e=>(0,t.jsx)(ee,{shift:e},e.id))})," "]})," "]})," "]})]})]})]})}ee.displayName="ShiftListItem"},12339:function(e,a,s){"use strict";s.d(a,{SP:function(){return d},dr:function(){return o},mQ:function(){return l},nU:function(){return c}});var t=s(57437),r=s(2265),i=s(20271),n=s(94508);let l=i.fC,o=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.aV,{ref:a,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});o.displayName=i.aV.displayName;let d=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.xz,{ref:a,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});d.displayName=i.xz.displayName;let c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.VY,{ref:a,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});c.displayName=i.VY.displayName},92651:function(e,a,s){"use strict";s.d(a,{CQ:function(){return c},Fl:function(){return f},TX:function(){return m},Ts:function(){return x},XB:function(){return l},bI:function(){return p},c0:function(){return h},hc:function(){return g},l5:function(){return o},pH:function(){return u},q9:function(){return d}});var t=s(43301),r=s(5978),i=s(17293);let n=(0,s(13491).V1)(i.wk,"createStaffUser"),l=async e=>{try{let a=await n(e);if(!a.data.success)throw Error("A fun\xe7\xe3o de backend n\xe3o retornou sucesso.");return a.data.user}catch(e){throw console.error("[AuthService] Erro ao chamar a fun\xe7\xe3o createStaffUser:",e),Error(e.message||"N\xe3o foi poss\xedvel adicionar o membro \xe0 Equipa.")}},o=async e=>{try{let a=(0,r.hJ)(i.db,"users"),s=(0,r.IO)(a,(0,r.ar)("hospitalId","==",e)),t=await (0,r.PL)(s);if(t.empty)return[];return t.docs.map(e=>({uid:e.id,...e.data()})).filter(a=>a.uid!==e)}catch(a){throw console.error("[AuthService] Erro ao buscar a Equipa para o hospital ".concat(e,":"),a),Error("N\xe3o foi poss\xedvel carregar a lista da Equipa.")}},d=async(e,a,s)=>{try{let r=await (0,t.Xb)(i.I8,e,a);return await (0,t.ck)(r.user,{displayName:s}),r.user}catch(e){throw console.error("[AuthService] Erro ao criar usu\xe1rio no Auth:",e),e}},c=async(e,a,s,t,n)=>{let l={};if("doctor"===t){let{documents:e,specialistDocuments:a,...s}=n;l={...s,documents:e,specialistDocuments:a,documentVerificationStatus:"PENDING_REVIEW",adminVerificationNotes:""}}else if("hospital"===t){let{hospitalDocs:e,legalRepDocuments:a,...s}=n;l={companyInfo:{cnpj:s.cnpj,stateRegistration:s.stateRegistration,phone:s.phone,address:s.address},legalRepresentativeInfo:s.legalRepresentativeInfo,hospitalDocs:e,legalRepDocuments:a,documentVerificationStatus:"PENDING_REVIEW",adminVerificationNotes:""}}else if(["receptionist","triage_nurse","caravan_admin","admin","backoffice"].includes(t))l={};else throw Error("Tipo de perfil de registro inv\xe1lido.");let o={uid:e,email:a,displayName:s,userType:t,createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)(),...l};await (0,r.pl)((0,r.JU)(i.db,"users",e),o),console.log("[AuthService] Perfil ".concat(t," salvo para UID: ").concat(e))},u=async(e,a)=>{try{return(await (0,t.e5)(i.I8,e,a)).user}catch(e){throw console.error("[AuthService] Login error:",e),e}},m=async()=>{try{await (0,t.w7)(i.I8)}catch(e){throw console.error("[AuthService] Logout error:",e),e}},h=async e=>{try{await (0,t.LS)(i.I8,e)}catch(e){throw console.error("[AuthService] Reset error:",e),e}},x=async()=>{let e=i.I8.currentUser;if(!e)return null;try{let a=(0,r.JU)(i.db,"users",e.uid),s=await (0,r.QT)(a);if(s.exists())return{uid:s.id,...s.data()};return null}catch(e){throw console.error("[AuthService] Get current user data error:",e),e}},p=async(e,a)=>{if(!e)throw Error("ID do Doutor n\xe3o fornecido para atualiza\xe7\xe3o.");if(!a||0===Object.keys(a).length){console.warn("[AuthService] Nenhum dado fornecido para atualiza\xe7\xe3o do perfil do doutor.");return}let s=(0,r.JU)(i.db,"users",e),t={};if(Object.keys(a).forEach(e=>{void 0!==a[e]&&("address"===e&&"object"==typeof a.address&&null!==a.address?Object.keys(a.address).forEach(e=>{void 0!==a.address[e]&&(t["address.".concat(e)]=a.address[e])}):t[e]=a[e])}),0===Object.keys(t).length){console.warn("[AuthService] Nenhum dado v\xe1lido para atualizar ap\xf3s filtrar undefined.");return}t.updatedAt=(0,r.Bt)();try{var n;let a=await (0,r.QT)(s);if(!a.exists()||(null===(n=a.data())||void 0===n?void 0:n.userType)!=="doctor")throw Error("Perfil de doutor n\xe3o encontrado ou tipo de usu\xe1rio incorreto para atualiza\xe7\xe3o.");await (0,r.r7)(s,t),console.log("[AuthService] Perfil do doutor ".concat(e," atualizado com sucesso."))}catch(a){throw console.error("[AuthService] Erro ao atualizar perfil do doutor ".concat(e,":"),a),a}},f=async(e,a)=>{try{let s=(0,r.hJ)(i.db,"users"),t=(0,r.IO)(s,(0,r.ar)("userType","==","doctor"),(0,r.ar)("specialties","array-contains",a),(0,r.ar)("healthUnitIds","array-contains",e)),n=await (0,r.PL)(t);if(n.empty)return[];return n.docs.map(e=>({uid:e.id,...e.data()}))}catch(e){throw console.error("[AuthService] Erro ao buscar m\xe9dicos associados por especialidade:",e),Error("N\xe3o foi poss\xedvel carregar a lista de m\xe9dicos para esta unidade.")}},g=async function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e)throw Error("ID do usu\xe1rio n\xe3o fornecido.");let n=(0,r.JU)(i.db,"users",e),l={documentVerificationStatus:a,adminVerificationNotes:s,documentRejectionReasons:t,updatedAt:(0,r.Bt)()};"APPROVED"===a&&(l.documentRejectionReasons={},l.adminVerificationNotes="");try{await (0,r.r7)(n,l)}catch(a){throw console.error("Erro ao atualizar status do usu\xe1rio ".concat(e,":"),a),Error("Falha ao atualizar o status do cadastro.")}}},33569:function(e,a,s){"use strict";s.d(a,{AX:function(){return l},CW:function(){return d},G2:function(){return o},S$:function(){return c},xf:function(){return n}});var t=s(5978),r=s(17293),i=s(92651);let n=async e=>{let a=r.I8.currentUser;if(!a)throw Error("Usu\xe1rio n\xe3o autenticado.");let s=await (0,i.Ts)();if(!s||"hospital"!==s.role)throw Error("Perfil de hospital n\xe3o encontrado ou inv\xe1lido.");let n={...e,hospitalId:a.uid,hospitalName:s.displayName,publishedByUID:a.uid,publishedByName:a.displayName||s.displayName||void 0,status:"OPEN",createdAt:(0,t.Bt)(),updatedAt:(0,t.Bt)()};try{let e=await (0,t.ET)((0,t.hJ)(r.db,"shiftRequirements"),n);return console.log("[SERVICE] Nova Demanda de Plant\xe3o adicionada com ID: ",e.id),e.id}catch(e){throw console.error("[SERVICE] Erro ao adicionar demanda:",e),e}},l=async(e,a)=>{if(!r.I8.currentUser)throw Error("Usu\xe1rio n\xe3o autenticado.");let s=(0,t.JU)(r.db,"shiftRequirements",e);try{await (0,t.r7)(s,{...a,updatedAt:(0,t.Bt)()}),console.log("[SERVICE] Demanda ID:",e,"atualizada.")}catch(e){throw console.error("[SERVICE] Erro ao atualizar demanda:",e),e}},o=async()=>{let e=r.I8.currentUser;if(!e)return[];try{let a=(0,t.IO)((0,t.hJ)(r.db,"shiftRequirements"),(0,t.ar)("hospitalId","==",e.uid),(0,t.ar)("status","==","OPEN"),(0,t.Xo)("createdAt","desc")),s=await (0,t.PL)(a),i=[];return s.forEach(e=>{i.push({id:e.id,...e.data()})}),console.log("[SERVICE] getHospitalShiftRequirements (OPEN): Encontradas ".concat(i.length," demandas.")),i}catch(e){throw console.error("[SERVICE] Erro getHospitalShiftRequirements:",e),e}},d=async e=>{if(!r.I8.currentUser)throw Error("Usu\xe1rio n\xe3o autenticado.");try{await (0,t.oe)((0,t.JU)(r.db,"shiftRequirements",e)),console.log("[SERVICE] Demanda deletada ID:",e)}catch(e){throw console.error("[SERVICE] Erro ao deletar demanda:",e),e}},c=async e=>{if(!e)throw Error("ID do hospital n\xe3o fornecido.");return{kpis:{},monthlyCosts:[],specialtyDemand:[]}}}},function(e){e.O(0,[4358,9990,6137,9084,9733,6838,4517,6008,9315,4084,7988,3294,2592,7956,2247,7271,7363,2971,2117,1744],function(){return e(e.s=7668)}),_N_E=e.O()}]);