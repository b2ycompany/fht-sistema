(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7537],{80723:function(e,s,a){Promise.resolve().then(a.bind(a,33009))},33009:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return G}});var t=a(57437),r=a(2265),i=a(62869),l=a(66070),o=a(12339),n=a(35974),d=a(35153),c=a(94508),m=a(33569),u=a(87598),h=a(51817),x=a(43044),p=a(49322),f=a(69076),j=a(65690),g=a(58896),b=a(88944),N=a(91723),v=a(95805),y=a(70525),E=a(46413),w=a(92651),S=a(37748),C=a(27648),k=a(47625),I=a(21156),D=a(56940),A=a(97059),P=a(62994),Z=a(8147),R=a(54061);let L=e=>{let{data:s,title:a,description:r,dataKey:i,strokeColor:o="#3b82f6"}=e;return s&&0!==s.length?(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsx)(l.ll,{className:"text-base font-semibold",children:a}),r&&(0,t.jsx)(l.SZ,{className:"text-sm",children:r})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(k.h,{width:"100%",height:250,children:(0,t.jsxs)(I.w,{data:s,margin:{top:5,right:20,left:10,bottom:5},children:[" ",(0,t.jsx)(D.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"})," ",(0,t.jsx)(A.K,{dataKey:"name",stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1}),(0,t.jsx)(P.B,{stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>(0,c.xG)(e)}),(0,t.jsx)(Z.u,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"12px"},formatter:e=>(0,c.xG)(e)}),(0,t.jsx)(R.x,{type:"monotone",dataKey:i,stroke:o,strokeWidth:2,activeDot:{r:6},dot:{r:3,fill:o}})]})})})]}):(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsx)(l.ll,{className:"text-base font-semibold",children:a}),r&&(0,t.jsx)(l.SZ,{className:"text-sm",children:r})]}),(0,t.jsx)(l.aY,{className:"h-[250px] flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Sem dados para exibir."})})]})};var O=a(77031),T=a(83046);let V=e=>{let{data:s,title:a,description:r,dataKey:i,fillColor:o="#3b82f6"}=e;if(!s||0===s.length)return(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsx)(l.ll,{className:"text-base font-semibold",children:a}),r&&(0,t.jsx)(l.SZ,{className:"text-sm",children:r})]}),(0,t.jsxs)(l.aY,{className:"h-[250px] flex items-center justify-center",children:[" ",(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Sem dados para exibir o gr\xe1fico."})]})]});let n=250+(s.length>6?30:0);return(0,t.jsxs)(l.Zb,{className:"shadow-sm hover:shadow-md transition-shadow duration-200",children:[" ",(0,t.jsxs)(l.Ol,{children:[(0,t.jsx)(l.ll,{className:"text-base font-semibold text-gray-800",children:a})," ",r&&(0,t.jsx)(l.SZ,{className:"text-sm text-gray-500",children:r})," "]}),(0,t.jsxs)(l.aY,{className:"pr-0 pl-1 sm:pl-0",children:[" ",(0,t.jsx)(k.h,{width:"100%",height:n,children:(0,t.jsxs)(O.v,{data:s,margin:{top:5,right:5,left:-15,bottom:40},children:[(0,t.jsx)(D.q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,t.jsx)(A.K,{dataKey:"name",stroke:"#6b7280",fontSize:11,tickLine:!1,axisLine:!1,angle:-45,textAnchor:"end",interval:0}),(0,t.jsx)(P.B,{stroke:"#6b7280",fontSize:12,tickLine:!1,axisLine:!1,allowDecimals:!1}),(0,t.jsx)(Z.u,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"0.375rem",fontSize:"12px"},cursor:{fill:"#f3f4f6"}}),(0,t.jsx)(T.$,{dataKey:i,fill:o,radius:[4,4,0,0],name:"Quantidade"})]})})]})]})};var U=a(67643);let _=r.memo(e=>{let{message:s="Carregando..."}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 min-h-[150px] w-full",children:[(0,t.jsx)(h.Z,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,t.jsx)("p",{className:"mt-3 text-sm text-gray-600",children:s})]})}),q=r.memo(e=>{let{title:s,message:a}=e;return(0,t.jsxs)("div",{className:"text-center text-sm text-gray-500 py-10 min-h-[150px] flex flex-col items-center justify-center bg-gray-50/70 rounded-md border border-dashed",children:[(0,t.jsx)(x.Z,{className:"w-12 h-12 text-gray-400 mb-4"}),(0,t.jsx)("p",{className:"font-medium text-gray-600 mb-1",children:s}),(0,t.jsx)("p",{children:a})]})}),z=r.memo(e=>{let{message:s,onRetry:a}=e;return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 min-h-[150px] w-full text-center text-sm text-red-600 bg-red-50/70 rounded-md border border-dashed border-red-300",children:[(0,t.jsx)(p.Z,{className:"w-12 h-12 text-red-400 mb-4"}),(0,t.jsx)("p",{className:"text-base font-semibold text-red-700 mb-1",children:"Oops!"}),(0,t.jsx)("p",{children:s||"N\xe3o foi poss\xedvel carregar."}),a&&(0,t.jsxs)(i.z,{variant:"destructive",size:"sm",onClick:a,className:"mt-4",children:[(0,t.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Tentar Novamente"]})]})}),B=e=>{let{title:s,value:a,description:r,icon:i,isLoading:o,href:n}=e,d=(0,t.jsxs)(l.Zb,{className:(0,c.cn)("shadow-sm transition-shadow duration-200 min-w-0",n?"hover:shadow-md hover:border-primary cursor-pointer":""),children:[(0,t.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.ll,{className:"text-sm font-medium text-gray-600 truncate pr-2",children:s}),(0,t.jsx)(i,{className:"h-4 w-4 text-muted-foreground shrink-0"})]}),(0,t.jsxs)(l.aY,{className:"pt-0 pb-3 px-3 overflow-hidden",children:[o?(0,t.jsx)("div",{className:"h-8 flex items-center",children:(0,t.jsx)(h.Z,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):(0,t.jsx)("div",{className:(0,c.cn)("font-bold text-gray-900","text-lg md:text-xl lg:text-2xl","leading-tight"),title:null==a?void 0:a.toString(),children:a}),r&&!o&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground pt-1 truncate",children:r})]})]});return n?(0,t.jsx)(C.default,{href:n,className:"no-underline",children:d}):d};function G(){var e,s,a,i,x,f,C,k,I;let{toast:D}=(0,d.pm)(),{user:A,loading:P}=(0,E.a)(),[Z,R]=(0,r.useState)(null),[O,T]=(0,r.useState)(null),[G,J]=(0,r.useState)([]),[M,Y]=(0,r.useState)(!0),[K,H]=(0,r.useState)(null),X=(0,r.useCallback)(async()=>{if(!A){Y(!1);return}Y(!0),H(null);try{let[e,s,a]=await Promise.all([(0,w.Ts)(),(0,m.S$)(A.uid),(0,u.LL)(["PENDING_HOSPITAL_SIGNATURE"])]);(null==e?void 0:e.role)==="hospital"&&T(e),R(s),J(a)}catch(e){H(e.message||"Erro ao carregar dados."),D({title:"Erro nos Dados",description:e.message,variant:"destructive"})}finally{Y(!1)}},[A,D]);(0,r.useEffect)(()=>{!P&&A?X():P||A||Y(!1)},[A,P,X]);let Q=async e=>{try{await (0,u.kb)(e),D({title:"Contrato Assinado!",description:"O plant\xe3o foi formalizado com sucesso."}),await X()}catch(e){D({title:"Erro ao Assinar",description:e.message,variant:"destructive"})}};return M&&!O?(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(_,{message:"A carregar dashboard..."})}):(0,t.jsxs)("div",{className:"flex flex-col gap-6 md:gap-8",children:[(0,t.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-gray-800",children:["Vis\xe3o Geral: ",(null==O?void 0:O.displayName)||"Hospital"]}),O&&(0,t.jsx)(S.Z,{status:O.documentVerificationStatus,adminNotes:O.adminVerificationNotes,userType:"hospital",editProfileLink:"/hospital/profile/edit"}),(0,t.jsxs)(o.mQ,{defaultValue:"overview",className:"w-full",children:[(0,t.jsxs)(o.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(o.SP,{value:"overview",children:"Vis\xe3o Geral"}),(0,t.jsxs)(o.SP,{value:"contracts",children:["Contratos Pendentes",(0,t.jsx)(n.C,{variant:G.length>0?"destructive":"secondary",className:"ml-2",children:M?(0,t.jsx)(h.Z,{className:"h-3 w-3 animate-spin"}):G.length})]})]}),(0,t.jsxs)(o.nU,{value:"overview",className:"mt-4",children:[(0,t.jsxs)("section",{"aria-labelledby":"kpi-heading",children:[(0,t.jsx)("h2",{id:"kpi-heading",className:"sr-only",children:"Indicadores Chave"}),(0,t.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-7",children:[(0,t.jsx)(B,{title:"Vagas Abertas",value:null!==(C=null==Z?void 0:null===(e=Z.kpis)||void 0===e?void 0:e.openShiftsCount)&&void 0!==C?C:"-",icon:p.Z,isLoading:M,description:"Aguardando m\xe9dicos",href:"/hospital/shifts"}),(0,t.jsx)(B,{title:"Pendentes A\xe7\xe3o",value:G.length,icon:j.Z,isLoading:M,description:"Contratos para assinar",href:"/hospital/contracts"}),(0,t.jsx)(B,{title:"Taxa Preenchim. (30d)",value:(0,c.rl)(null==Z?void 0:null===(s=Z.kpis)||void 0===s?void 0:s.fillRateLast30Days),icon:g.Z,isLoading:M,description:"Efici\xeancia"}),(0,t.jsx)(B,{title:"Custo Estimado (30d)",value:(0,c.xG)(null==Z?void 0:null===(a=Z.kpis)||void 0===a?void 0:a.costLast30Days),icon:b.Z,isLoading:M,description:"Gasto com plant\xf5es"}),(0,t.jsx)(B,{title:"Tempo M\xe9dio Preench.",value:(0,c.bx)(null==Z?void 0:null===(i=Z.kpis)||void 0===i?void 0:i.avgTimeToFillHours),icon:N.Z,isLoading:M,description:"Agilidade (horas)"}),(0,t.jsx)(B,{title:"M\xe9dicos na Plataforma",value:null!==(k=null==Z?void 0:null===(x=Z.kpis)||void 0===x?void 0:x.totalDoctorsOnPlatform)&&void 0!==k?k:"-",icon:v.Z,isLoading:M,description:"Total cadastrados"}),(0,t.jsx)(B,{title:"Top Demanda (Espec.)",value:null!==(I=null==Z?void 0:null===(f=Z.kpis)||void 0===f?void 0:f.topSpecialtyDemand)&&void 0!==I?I:"-",icon:y.Z,isLoading:M,description:"Mais requisitada"})]})]}),(0,t.jsxs)("section",{"aria-labelledby":"charts-heading",className:"mt-6",children:[(0,t.jsx)("h2",{id:"charts-heading",className:"text-xl font-semibold mb-4 text-gray-700",children:"An\xe1lises Gr\xe1ficas"}),K&&(!(null==Z?void 0:Z.monthlyCosts)||!(null==Z?void 0:Z.specialtyDemand))&&(0,t.jsx)(z,{message:"Erro ao carregar dados para gr\xe1ficos: ".concat(K),onRetry:X}),(0,t.jsxs)("div",{className:"grid gap-4 grid-cols-1 lg:grid-cols-2",children:[!M||(null==Z?void 0:Z.monthlyCosts)?(null==Z?void 0:Z.monthlyCosts)&&(0,t.jsx)(L,{data:Z.monthlyCosts,title:"Custo Mensal Estimado",description:"Evolu\xe7\xe3o dos gastos",dataKey:"valor",strokeColor:"#16a34a"}):(0,t.jsx)(l.Zb,{children:(0,t.jsx)(l.aY,{className:"h-[318px] flex items-center justify-center",children:(0,t.jsx)(_,{})})}),!M||(null==Z?void 0:Z.specialtyDemand)?(null==Z?void 0:Z.specialtyDemand)&&(0,t.jsx)(V,{data:Z.specialtyDemand,title:"Demanda por Especialidade",description:"Especialidades mais requisitadas",dataKey:"valor",fillColor:"#3b82f6"}):(0,t.jsx)(l.Zb,{children:(0,t.jsx)(l.aY,{className:"h-[318px] flex items-center justify-center",children:(0,t.jsx)(_,{})})})]})]})]}),(0,t.jsx)(o.nU,{value:"contracts",className:"mt-4",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsx)(l.ll,{children:"Contratos Aguardando sua Assinatura"}),(0,t.jsx)(l.SZ,{children:"Plant\xf5es aceitos pelos m\xe9dicos que precisam da sua assinatura final."})]}),(0,t.jsx)(l.aY,{children:M?(0,t.jsx)(_,{message:"A buscar contratos..."}):K?(0,t.jsx)(z,{message:K,onRetry:X}):0===G.length?(0,t.jsx)(q,{title:"Nenhum contrato pendente",message:"Quando um m\xe9dico aceitar uma proposta, aparecer\xe1 aqui."}):(0,t.jsx)("div",{className:"space-y-4",children:G.map(e=>(0,t.jsx)(U.C,{contract:e,onSign:Q,userType:"hospital"},e.id))})})]})})]})]})}},37748:function(e,s,a){"use strict";var t=a(57437);a(2265);var r=a(33245),i=a(41671),l=a(76865),o=a(27648);let n=e=>{let{status:s,adminNotes:a,userType:n,editProfileLink:d}=e;return s?"PENDING_REVIEW"===s?(0,t.jsxs)("div",{className:"p-4 mb-6 text-sm text-blue-700 bg-blue-100 rounded-lg border border-blue-300",role:"alert",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(r.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,t.jsx)("span",{className:"font-medium",children:"Seu cadastro est\xe1 em an\xe1lise."})]}),(0,t.jsx)("p",{className:"mt-1.5 ml-8",children:"Avisaremos assim que o processo de verifica\xe7\xe3o for conclu\xeddo. Obrigado pela sua paci\xeancia!"})]}):"APPROVED"===s?(0,t.jsxs)("div",{className:"p-4 mb-6 text-sm text-green-700 bg-green-100 rounded-lg border border-green-300",role:"alert",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(i.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,t.jsx)("span",{className:"font-medium",children:"Seu cadastro foi aprovado!"})]}),(0,t.jsx)("p",{className:"mt-1.5 ml-8",children:"Voc\xea j\xe1 pode utilizar todas as funcionalidades da plataforma."})]}):"REJECTED_NEEDS_RESUBMISSION"===s?(0,t.jsxs)("div",{className:"p-4 mb-6 text-sm text-red-700 bg-red-100 rounded-lg border border-red-300",role:"alert",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(l.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,t.jsx)("span",{className:"font-medium",children:"Seu cadastro precisa de corre\xe7\xf5es."})]}),a&&(0,t.jsxs)("div",{className:"mt-2.5 ml-8",children:[(0,t.jsx)("strong",{className:"block mb-1",children:"Observa\xe7\xf5es do Administrador:"}),(0,t.jsx)("p",{className:"whitespace-pre-wrap bg-red-50 p-2 rounded border border-red-200",children:a})]}),(0,t.jsxs)("p",{className:"mt-2.5 ml-8",children:["Por favor, revise as informa\xe7\xf5es e/ou documentos solicitados e fa\xe7a as corre\xe7\xf5es necess\xe1rias.",(0,t.jsx)(o.default,{href:d||("doctor"===n?"/dashboard/profile/edit":"/hospital/profile/edit"),className:"ml-1 font-semibold text-red-800 hover:text-red-900 underline",children:"Clique aqui para corrigir seu cadastro."})]})]}):null:null};n.displayName="ProfileStatusAlert",s.Z=n},33569:function(e,s,a){"use strict";a.d(s,{AX:function(){return o},CW:function(){return d},G2:function(){return n},N_:function(){return p},S$:function(){return c},YY:function(){return u},d5:function(){return h},iC:function(){return m},m3:function(){return x},or:function(){return f},xf:function(){return l}});var t=a(5978),r=a(17293),i=a(92651);let l=async e=>{let s=r.I8.currentUser;if(!s)throw Error("Usu\xe1rio n\xe3o autenticado.");let a=await (0,i.Ts)();if(!a||"hospital"!==a.role)throw Error("Perfil de hospital n\xe3o encontrado ou inv\xe1lido.");let l={...e,hospitalId:s.uid,hospitalName:a.displayName,publishedByUID:s.uid,publishedByName:s.displayName||a.displayName||void 0,status:"OPEN",createdAt:(0,t.Bt)(),updatedAt:(0,t.Bt)()};try{let e=await (0,t.ET)((0,t.hJ)(r.db,"shiftRequirements"),l);return console.log("[SERVICE] Nova Demanda de Plant\xe3o adicionada com ID: ",e.id),e.id}catch(e){throw console.error("[SERVICE] Erro ao adicionar demanda:",e),e}},o=async(e,s)=>{if(!r.I8.currentUser)throw Error("Usu\xe1rio n\xe3o autenticado.");let a=(0,t.JU)(r.db,"shiftRequirements",e);try{await (0,t.r7)(a,{...s,updatedAt:(0,t.Bt)()}),console.log("[SERVICE] Demanda ID:",e,"atualizada.")}catch(e){throw console.error("[SERVICE] Erro ao atualizar demanda:",e),e}},n=async()=>{let e=r.I8.currentUser;if(!e)return[];try{let s=(0,t.IO)((0,t.hJ)(r.db,"shiftRequirements"),(0,t.ar)("hospitalId","==",e.uid),(0,t.ar)("status","==","OPEN"),(0,t.Xo)("createdAt","desc")),a=await (0,t.PL)(s),i=[];return a.forEach(e=>{i.push({id:e.id,...e.data()})}),console.log("[SERVICE] getHospitalShiftRequirements (OPEN): Encontradas ".concat(i.length," demandas.")),i}catch(e){throw console.error("[SERVICE] Erro getHospitalShiftRequirements:",e),e}},d=async e=>{if(!r.I8.currentUser)throw Error("Usu\xe1rio n\xe3o autenticado.");try{await (0,t.oe)((0,t.JU)(r.db,"shiftRequirements",e)),console.log("[SERVICE] Demanda deletada ID:",e)}catch(e){throw console.error("[SERVICE] Erro ao deletar demanda:",e),e}},c=async e=>{if(!e)throw Error("ID do hospital n\xe3o fornecido.");return{kpis:{},monthlyCosts:[],specialtyDemand:[]}},m=async()=>[],u=async()=>[],h=async()=>[],x=async()=>{let e=r.I8.currentUser;if(!e)return[];try{let s=(0,t.hJ)(r.db,"users",e.uid,"hospitalDoctors"),a=(0,t.IO)(s,(0,t.Xo)("name","asc")),i=await (0,t.PL)(a);if(i.empty)return[];return i.docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Erro ao buscar m\xe9dicos gerenciados:",e),[]}},p=async(e,s)=>{if(!e||!s.crm||!s.name)throw Error("Dados insuficientes para cadastrar o m\xe9dico (Nome e CRM s\xe3o obrigat\xf3rios).");let a=(0,t.hJ)(r.db,"users");await (0,t.i3)(r.db,async i=>{if(s.email){let e=(0,t.IO)(a,(0,t.ar)("email","==",s.email));if(!(await (0,t.PL)(e)).empty)throw Error("O email ".concat(s.email," j\xe1 est\xe1 cadastrado na plataforma."))}let l=(0,t.IO)(a,(0,t.ar)("professionalCrm","==",s.crm));if(!(await (0,t.PL)(l)).empty)throw Error("O CRM ".concat(s.crm," j\xe1 est\xe1 cadastrado na plataforma."));let o=(0,t.JU)((0,t.hJ)(r.db,"users"));i.set(o,{displayName:s.name,email:s.email||"",professionalCrm:s.crm,phone:s.phone||"",specialties:s.specialties||[],role:"doctor",documentVerificationStatus:"PENDING_DOCUMENTS",onboardingMethod:"EXTERNAL_HOSPITAL_INVITE",onboardedByHospitalId:e,createdAt:(0,t.Bt)(),updatedAt:(0,t.Bt)()});let n=(0,t.JU)((0,t.hJ)(r.db,"users",e,"hospitalDoctors"),o.id);i.set(n,{id:o.id,name:s.name,crm:s.crm,email:s.email||"",phone:s.phone||"",specialties:s.specialties||[],status:"ACTIVE_EXTERNAL",source:"EXTERNAL",addedAt:(0,t.Bt)()})})},f=async(e,s,a)=>(console.log("[SERVICE] Hospital ".concat(e," atualizando m\xe9dico ").concat(s," (MOCK):"),a),await new Promise(e=>setTimeout(e,400)),{success:!0,message:"Dados do m\xe9dico ".concat(a.name||s," atualizados (mock).")})}},function(e){e.O(0,[4358,9990,6137,9084,7648,1543,7877,8398,1564,8323,4626,214,2971,2117,1744],function(){return e(e.s=80723)}),_N_E=e.O()}]);