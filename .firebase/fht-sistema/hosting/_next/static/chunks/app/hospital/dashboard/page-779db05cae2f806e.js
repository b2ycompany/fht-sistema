(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7537],{80723:function(e,s,a){Promise.resolve().then(a.bind(a,30897))},30897:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return C}});var r=a(57437),t=a(2265),i=a(62869),l=a(66070),n=a(12339),o=a(35974),d=a(35153),c=a(33569),u=a(87598),m=a(51817),f=a(26937),h=a(46413),x=a(92651),p=a(37748);a(27648);var j=a(73578),v=a(26110),g=a(95186),N=a(26815),b=a(53647),y=a(5978),S=a(17293);let w=(0,t.memo)(e=>{let{message:s="Carregando..."}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 min-h-[150px] w-full",children:[(0,r.jsx)(m.Z,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,r.jsx)("p",{className:"mt-3 text-sm text-gray-600",children:s})]})}),A=e=>{let{hospitalId:s,onStaffAdded:a}=e,{toast:l}=(0,d.pm)(),[n,o]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[f,h]=(0,t.useState)(""),[p,j]=(0,t.useState)(!1),y=async()=>{if(!n||!c||!f){l({title:"Campos obrigat\xf3rios",description:"Preencha nome, email e a fun\xe7\xe3o.",variant:"destructive"});return}j(!0);try{await (0,x.XB)({hospitalId:s,name:n,email:c,userType:f}),l({title:"Sucesso!",description:"".concat(n," foi adicionado(a) \xe0 Equipa. Um email com instru\xe7\xf5es ser\xe1 enviado."),className:"bg-green-600 text-white"}),a()}catch(e){l({title:"Erro ao criar profissional",description:e.message,variant:"destructive"})}finally{j(!1)}};return(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsx)(N._,{htmlFor:"name",children:"Nome Completo"}),(0,r.jsx)(g.I,{id:"name",value:n,onChange:e=>o(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsx)(N._,{htmlFor:"email",children:"Email"}),(0,r.jsx)(g.I,{id:"email",type:"email",value:c,onChange:e=>u(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsx)(N._,{htmlFor:"userType",children:"Fun\xe7\xe3o"}),(0,r.jsxs)(b.Ph,{value:f,onValueChange:e=>h(e),children:[(0,r.jsx)(b.i4,{children:(0,r.jsx)(b.ki,{placeholder:"Selecione uma fun\xe7\xe3o..."})}),(0,r.jsxs)(b.Bw,{children:[(0,r.jsx)(b.Ql,{value:"receptionist",children:"Recepcionista"}),(0,r.jsx)(b.Ql,{value:"triage_nurse",children:"Enfermeiro(a) de Triagem"}),(0,r.jsx)(b.Ql,{value:"caravan_admin",children:"Administrativo"})]})]})]}),(0,r.jsx)(v.cN,{className:"mt-4",children:(0,r.jsxs)(i.z,{onClick:y,disabled:p,children:[p&&(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"})," Adicionar Membro"]})})]})};function C(){let{toast:e}=(0,d.pm)(),{user:s,loading:a}=(0,h.a)(),[g,N]=(0,t.useState)(null),[b,C]=(0,t.useState)(null),[E,P]=(0,t.useState)([]),[R,k]=(0,t.useState)([]),[_,T]=(0,t.useState)(!0),[V,I]=(0,t.useState)(null),[U,Z]=(0,t.useState)(!1),q=(0,t.useCallback)(async()=>{if(!s){T(!1);return}T(!0),I(null);try{let[e,a,r]=await Promise.all([(0,x.Ts)(),(0,c.S$)(s.uid),(0,u.LL)(["PENDING_HOSPITAL_SIGNATURE"])]);(null==e?void 0:e.userType)==="hospital"&&C(e),N(a),P(r)}catch(s){I(s.message||"Erro ao carregar dados."),e({title:"Erro nos Dados",description:s.message,variant:"destructive"})}finally{T(!1)}},[s,e]);return((0,t.useEffect)(()=>{!a&&s?q():a||s||T(!1)},[s,a,q]),(0,t.useEffect)(()=>{if(!s)return;let e=(0,y.IO)((0,y.hJ)(S.db,"users"),(0,y.ar)("hospitalId","==",s.uid)),a=(0,y.cf)(e,e=>{k(e.docs.map(e=>({uid:e.id,...e.data()})))},e=>{I("Falha ao carregar a Equipa em tempo real.")});return()=>a()},[s]),_&&!b)?(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(w,{message:"A carregar dashboard..."})}):(0,r.jsxs)("div",{className:"flex flex-col gap-6 md:gap-8",children:[(0,r.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-gray-800",children:["Vis\xe3o Geral: ",(null==b?void 0:b.displayName)||"Hospital"]}),b&&(0,r.jsx)(p.Z,{status:b.documentVerificationStatus,adminNotes:b.adminVerificationNotes,userType:"hospital",editProfileLink:"/hospital/profile/edit"}),(0,r.jsxs)(n.mQ,{defaultValue:"overview",className:"w-full",children:[(0,r.jsxs)(n.dr,{className:"grid w-full grid-cols-3",children:[(0,r.jsx)(n.SP,{value:"overview",children:"Vis\xe3o Geral"}),(0,r.jsxs)(n.SP,{value:"contracts",children:["Contratos Pendentes",(0,r.jsx)(o.C,{variant:E.length>0?"destructive":"secondary",className:"ml-2",children:_?(0,r.jsx)(m.Z,{className:"h-3 w-3 animate-spin"}):E.length})]}),(0,r.jsxs)(n.SP,{value:"Equipa",children:["Gest\xe3o de Equipa",(0,r.jsx)(o.C,{variant:"secondary",className:"ml-2",children:R.length})]})]}),(0,r.jsx)(n.nU,{value:"overview",className:"mt-4"}),(0,r.jsx)(n.nU,{value:"contracts",className:"mt-4"}),(0,r.jsx)(n.nU,{value:"Equipa",className:"mt-4",children:(0,r.jsxs)(l.Zb,{children:[(0,r.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(l.ll,{children:"Equipa da Unidade"}),(0,r.jsx)(l.SZ,{children:"Adicione e visualize os profissionais da sua unidade."})]}),(0,r.jsxs)(i.z,{onClick:()=>Z(!0),children:[(0,r.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Adicionar Membro"]})]}),(0,r.jsx)(l.aY,{children:(0,r.jsxs)(j.iA,{children:[(0,r.jsx)(j.xD,{children:(0,r.jsxs)(j.SC,{children:[(0,r.jsx)(j.ss,{children:"Nome"}),(0,r.jsx)(j.ss,{children:"Email"}),(0,r.jsx)(j.ss,{children:"Fun\xe7\xe3o"})]})}),(0,r.jsx)(j.RM,{children:R.length>0?R.map(e=>{var s;return(0,r.jsxs)(j.SC,{children:[(0,r.jsx)(j.pj,{className:"font-medium",children:e.displayName}),(0,r.jsx)(j.pj,{children:e.email}),(0,r.jsx)(j.pj,{className:"capitalize",children:(null===(s=e.userType)||void 0===s?void 0:s.replace(/_/g," "))||"N/A"})]},e.uid)}):(0,r.jsx)(j.SC,{children:(0,r.jsx)(j.pj,{colSpan:3,className:"h-24 text-center",children:"Nenhum profissional cadastrado ainda."})})})]})})]})})]}),(0,r.jsx)(v.Vq,{open:U,onOpenChange:Z,children:(0,r.jsxs)(v.cZ,{children:[(0,r.jsxs)(v.fK,{children:[(0,r.jsx)(v.$N,{children:"Adicionar Novo Membro \xe0 Equipa"}),(0,r.jsx)(v.Be,{children:"Um convite com uma senha tempor\xe1ria ser\xe1 enviado para o email do profissional."})]}),s&&(0,r.jsx)(A,{hospitalId:s.uid,onStaffAdded:()=>Z(!1)})]})})]})}},46413:function(e,s,a){"use strict";a.d(s,{AuthProvider:function(){return d},a:function(){return c}});var r=a(57437),t=a(2265),i=a(43301),l=a(17293),n=a(92651);let o=(0,t.createContext)(void 0),d=e=>{let{children:s}=e,[a,d]=(0,t.useState)(null),[c,u]=(0,t.useState)(null),[m,f]=(0,t.useState)(!0),[h,x]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{console.log("[AuthProvider] Subscribing to onAuthStateChanged (montagem do provider)");let e=(0,i.Aj)(l.I8,async e=>{if(console.log("[AuthProvider] onAuthStateChanged: User state changed. New Firebase user:",e?e.uid:null),d(e),e){x(!0);try{let e=await (0,n.Ts)();u(e),console.log("[AuthProvider] onAuthStateChanged: Profile fetched after user state change:",e)}catch(e){console.error("[AuthProvider] onAuthStateChanged: Error fetching profile:",e),u(null)}finally{x(!1)}}else u(null),x(!1);f(!1),console.log("[AuthProvider] onAuthStateChanged: Loading set to false.")});return()=>{console.log("[AuthProvider] Unsubscribing from onAuthStateChanged (desmontagem do provider)"),e()}},[]),console.log("[AuthProvider] Context values updated - User:",a?a.uid:null,"Loading:",m,"ProfileLoading:",h),(0,r.jsx)(o.Provider,{value:{user:a,userProfile:c,loading:m,profileLoading:h},children:s})},c=()=>{let e=(0,t.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},37748:function(e,s,a){"use strict";var r=a(57437);a(2265);var t=a(33245),i=a(41671),l=a(76865),n=a(27648);let o=e=>{let{status:s,adminNotes:a,userType:o,editProfileLink:d}=e;return s?"PENDING_REVIEW"===s?(0,r.jsxs)("div",{className:"p-4 mb-6 text-sm text-blue-700 bg-blue-100 rounded-lg border border-blue-300",role:"alert",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(t.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:"Seu cadastro est\xe1 em an\xe1lise."})]}),(0,r.jsx)("p",{className:"mt-1.5 ml-8",children:"Avisaremos assim que o processo de verifica\xe7\xe3o for conclu\xeddo. Obrigado pela sua paci\xeancia!"})]}):"APPROVED"===s?(0,r.jsxs)("div",{className:"p-4 mb-6 text-sm text-green-700 bg-green-100 rounded-lg border border-green-300",role:"alert",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(i.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:"Seu cadastro foi aprovado!"})]}),(0,r.jsx)("p",{className:"mt-1.5 ml-8",children:"Voc\xea j\xe1 pode utilizar todas as funcionalidades da plataforma."})]}):"REJECTED_NEEDS_RESUBMISSION"===s?(0,r.jsxs)("div",{className:"p-4 mb-6 text-sm text-red-700 bg-red-100 rounded-lg border border-red-300",role:"alert",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:"Seu cadastro precisa de corre\xe7\xf5es."})]}),a&&(0,r.jsxs)("div",{className:"mt-2.5 ml-8",children:[(0,r.jsx)("strong",{className:"block mb-1",children:"Observa\xe7\xf5es do Administrador:"}),(0,r.jsx)("p",{className:"whitespace-pre-wrap bg-red-50 p-2 rounded border border-red-200",children:a})]}),(0,r.jsxs)("p",{className:"mt-2.5 ml-8",children:["Por favor, revise as informa\xe7\xf5es e/ou documentos solicitados e fa\xe7a as corre\xe7\xf5es necess\xe1rias.",(0,r.jsx)(n.default,{href:d||("doctor"===o?"/dashboard/profile/edit":"/hospital/profile/edit"),className:"ml-1 font-semibold text-red-800 hover:text-red-900 underline",children:"Clique aqui para corrigir seu cadastro."})]})]}):null:null};o.displayName="ProfileStatusAlert",s.Z=o},73578:function(e,s,a){"use strict";a.d(s,{RM:function(){return o},SC:function(){return d},iA:function(){return l},pj:function(){return u},ss:function(){return c},xD:function(){return n}});var r=a(57437),t=a(2265),i=a(94508);let l=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,i.cn)("w-full caption-bottom text-sm",a),...t})})});l.displayName="Table";let n=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("thead",{ref:s,className:(0,i.cn)("[&_tr]:border-b",a),...t})});n.displayName="TableHeader";let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("tbody",{ref:s,className:(0,i.cn)("[&_tr:last-child]:border-0",a),...t})});o.displayName="TableBody",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("tfoot",{ref:s,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t})}).displayName="TableFooter";let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("tr",{ref:s,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t})});d.displayName="TableRow";let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("th",{ref:s,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t})});c.displayName="TableHead";let u=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("td",{ref:s,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t})});u.displayName="TableCell",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("caption",{ref:s,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",a),...t})}).displayName="TableCaption"},12339:function(e,s,a){"use strict";a.d(s,{SP:function(){return d},dr:function(){return o},mQ:function(){return n},nU:function(){return c}});var r=a(57437),t=a(2265),i=a(20271),l=a(94508);let n=i.fC,o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(i.aV,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...t})});o.displayName=i.aV.displayName;let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(i.xz,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...t})});d.displayName=i.xz.displayName;let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(i.VY,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...t})});c.displayName=i.VY.displayName}},function(e){e.O(0,[4358,9990,6137,9084,9733,7648,6838,4517,6008,9315,8645,7607,34,2971,2117,1744],function(){return e(e.s=80723)}),_N_E=e.O()}]);