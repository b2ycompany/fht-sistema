(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1899],{12017:function(e,a,s){Promise.resolve().then(s.bind(s,31159))},31159:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return _}});var t=s(57437),l=s(2265),r=s(27648),i=s(99376),c=s(18331),n=s(92651),d=s(46413),o=s(35153),m=s(51817),u=s(83229),x=s(76865),h=s(32660),p=s(23759),j=s(31047),N=s(95337),f=s(41671),v=s(66070),g=s(62869),y=s(76818),b=s(26815),w=s(12339);let S=e=>{let{data:a}=e;return(0,t.jsxs)("div",{className:"space-y-3 mt-4",children:[(0,t.jsxs)("div",{className:"p-3 bg-blue-50 rounded-md border border-blue-200",children:[(0,t.jsx)(b._,{className:"text-gray-500",children:"Queixa Principal"}),(0,t.jsx)("p",{className:"font-semibold whitespace-pre-wrap",children:(null==a?void 0:a.chiefComplaint)||"N\xe3o informada"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"p-2 bg-slate-50 rounded-md border",children:[(0,t.jsx)(b._,{className:"text-xs text-gray-500 block",children:"Press\xe3o Arterial"}),(0,t.jsx)("p",{className:"font-medium",children:(null==a?void 0:a.bloodPressure)||"-"})]}),(0,t.jsxs)("div",{className:"p-2 bg-slate-50 rounded-md border",children:[(0,t.jsx)(b._,{className:"text-xs text-gray-500 block",children:"Temperatura"}),(0,t.jsx)("p",{className:"font-medium",children:(null==a?void 0:a.temperature)?"".concat(a.temperature," \xb0C"):"-"})]}),(0,t.jsxs)("div",{className:"p-2 bg-slate-50 rounded-md border",children:[(0,t.jsx)(b._,{className:"text-xs text-gray-500 block",children:"Freq. Card\xedaca"}),(0,t.jsx)("p",{className:"font-medium",children:(null==a?void 0:a.heartRate)?"".concat(a.heartRate," bpm"):"-"})]}),(0,t.jsxs)("div",{className:"p-2 bg-slate-50 rounded-md border",children:[(0,t.jsx)(b._,{className:"text-xs text-gray-500 block",children:"Freq. Respirat\xf3ria"}),(0,t.jsx)("p",{className:"font-medium",children:(null==a?void 0:a.respiratoryRate)?"".concat(a.respiratoryRate," rpm"):"-"})]}),(0,t.jsxs)("div",{className:"p-2 bg-slate-50 rounded-md border",children:[(0,t.jsx)(b._,{className:"text-xs text-gray-500 block",children:"Satura\xe7\xe3o Oâ‚‚"}),(0,t.jsx)("p",{className:"font-medium",children:(null==a?void 0:a.oxygenSaturation)?"".concat(a.oxygenSaturation," %"):"-"})]})]}),(null==a?void 0:a.notes)&&(0,t.jsxs)("div",{className:"p-3 bg-yellow-50 rounded-md border border-yellow-200",children:[(0,t.jsx)(b._,{className:"text-gray-500",children:"Outras Anota\xe7\xf5es da Triagem"}),(0,t.jsx)("p",{className:"whitespace-pre-wrap",children:a.notes})]})]})},E=e=>{let{consultation:a,userProfile:s}=e,{toast:r}=(0,o.pm)(),[i,n]=(0,l.useState)((null==a?void 0:a.clinicalEvolution)||""),[d,x]=(0,l.useState)((null==a?void 0:a.diagnosticHypothesis)||""),[h,p]=(0,l.useState)(!1),j=async()=>{p(!0);try{await (0,c.KO)(a.id,{clinicalEvolution:i,diagnosticHypothesis:d}),r({title:"Sucesso!",description:"Prontu\xe1rio salvo."})}catch(e){r({title:"Erro ao Salvar",description:e.message,variant:"destructive"})}finally{p(!1)}};return(0,t.jsxs)(v.Zb,{className:"h-full flex flex-col",children:[(0,t.jsx)(v.Ol,{children:(0,t.jsx)(v.ll,{className:"text-lg",children:"Prontu\xe1rio Eletr\xf4nico"})}),(0,t.jsxs)(v.aY,{className:"flex-grow flex flex-col gap-4 overflow-y-auto",children:[(0,t.jsxs)(w.mQ,{defaultValue:"triage",className:"flex-grow flex flex-col",children:[(0,t.jsxs)(w.dr,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(w.SP,{value:"triage",children:"Triagem"}),(0,t.jsx)(w.SP,{value:"patient-data",children:"Paciente"}),(0,t.jsx)(w.SP,{value:"medical-record",children:"Atendimento"}),(0,t.jsx)(w.SP,{value:"documents",children:"Documentos"})]}),(0,t.jsx)(w.nU,{value:"triage",className:"flex-grow",children:(0,t.jsx)(S,{data:a.triageData})}),(0,t.jsxs)(w.nU,{value:"patient-data",className:"text-sm space-y-3 mt-4 flex-grow",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(b._,{className:"text-gray-500",children:"Nome"}),(0,t.jsx)("p",{children:a.patientName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b._,{className:"text-gray-500",children:"Hist\xf3rico"}),(0,t.jsx)("p",{className:"whitespace-pre-wrap",children:a.medicalHistorySummary||"Nenhum hist\xf3rico informado."})]})]}),(0,t.jsxs)(w.nU,{value:"medical-record",className:"flex-grow flex flex-col gap-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5 flex flex-col flex-grow",children:[(0,t.jsx)(b._,{htmlFor:"evolution",children:"Evolu\xe7\xe3o Cl\xednica"}),(0,t.jsx)(y.g,{id:"evolution",value:i,onChange:e=>n(e.target.value),className:"min-h-[150px] flex-grow"})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(b._,{htmlFor:"hypothesis",children:"Hip\xf3tese Diagn\xf3stica"}),(0,t.jsx)(y.g,{id:"hypothesis",value:d,onChange:e=>x(e.target.value)})]})]}),(0,t.jsx)(w.nU,{value:"documents",className:"mt-4 space-y-4",children:(0,t.jsx)("p",{className:"text-xs text-center text-gray-400",children:"A gera\xe7\xe3o de documentos (receitas, atestados, etc.) aparecer\xe1 aqui."})})]}),(0,t.jsx)("div",{className:"mt-auto pt-4",children:(0,t.jsxs)(g.z,{onClick:j,disabled:h,className:"w-full",children:[h?(0,t.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Salvar Anota\xe7\xf5es"]})})]})]})};function _(){let e=(0,i.useParams)(),a=(0,i.useRouter)(),{user:s}=(0,d.a)(),{toast:u}=(0,o.pm)(),y=e.consultaId,[b,w]=(0,l.useState)(null),[S,_]=(0,l.useState)(null),[P,C]=(0,l.useState)(!0),[D,I]=(0,l.useState)(!1),[A,Z]=(0,l.useState)(null);(0,l.useEffect)(()=>{y&&s&&(async()=>{C(!0);try{let[e,a]=await Promise.all([(0,c.xr)(y),(0,n.Ts)()]);if(!e||e.doctorId!==s.uid)throw Error("Consulta n\xe3o encontrada ou acesso n\xe3o permitido.");w(e),_(a)}catch(e){Z(e.message)}finally{C(!1)}})()},[y,s]);let k=async()=>{if(b){I(!0);try{await (0,c.yd)(b),u({title:"Atendimento Finalizado!",description:"O paciente foi removido da sua fila de espera."}),a.push("/dashboard")}catch(e){u({title:"Erro ao Finalizar",description:e.message,variant:"destructive"}),I(!1)}}};return P?(0,t.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,t.jsx)(m.Z,{className:"h-8 w-8 animate-spin"})}):A?(0,t.jsxs)("div",{className:"text-center text-red-600 p-8",children:[(0,t.jsx)(x.Z,{className:"mx-auto h-12 w-12 mb-4"}),(0,t.jsx)("p",{children:A})]}):b?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(r.default,{href:"/dashboard",className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Voltar para o Dashboard"]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 h-[calc(100vh-120px)]",children:[(0,t.jsx)("div",{className:"md:col-span-2 h-full",children:(0,t.jsx)(E,{consultation:b,userProfile:S})}),(0,t.jsx)("div",{className:"h-full",children:(0,t.jsxs)(v.Zb,{className:"h-full flex flex-col",children:[(0,t.jsx)(v.Ol,{children:(0,t.jsx)(v.ll,{children:"Detalhes do Atendimento"})}),(0,t.jsxs)(v.aY,{className:"space-y-4 text-sm flex-grow",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5 text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Local"}),(0,t.jsx)("p",{children:b.hospitalName})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(j.Z,{className:"h-5 w-5 text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Data"}),(0,t.jsx)("p",{children:b.createdAt.toDate().toLocaleDateString("pt-BR")})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(N.Z,{className:"h-5 w-5 text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Tipo de Atendimento"}),(0,t.jsx)("p",{children:b.serviceType})]})]})]}),(0,t.jsx)(v.eW,{className:"mt-auto border-t pt-4",children:(0,t.jsxs)(g.z,{onClick:k,disabled:D,className:"w-full bg-green-600 hover:bg-green-700",children:[D?(0,t.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Finalizar Atendimento"]})})]})})]})]}):(0,t.jsx)("div",{className:"p-4 text-center",children:"Dados da consulta n\xe3o encontrados."})}},18331:function(e,a,s){"use strict";s.d(a,{KO:function(){return n},hC:function(){return r},xr:function(){return c},yd:function(){return i}});var t=s(5978),l=s(17293);let r=async(e,a)=>{var s;let r=(0,t.qs)(l.db),i=(0,t.JU)((0,t.hJ)(l.db,"consultations")),c={patientId:e.patientId,patientName:e.patientName,chiefComplaint:(null===(s=e.triageData)||void 0===s?void 0:s.chiefComplaint)||"N\xe3o informado",queueId:e.id,doctorId:a.uid,doctorName:a.displayName,hospitalId:e.unitId,hospitalName:"Nome da Unidade",serviceType:"Presencial",status:"IN_PROGRESS",createdAt:(0,t.Bt)(),triageData:e.triageData||{}};r.set(i,c);let n=(0,t.JU)(l.db,"serviceQueue",e.id);return r.update(n,{status:"Em Atendimento",doctorId:a.uid}),await r.commit(),i.id},i=async e=>{let a=(0,t.qs)(l.db),s=(0,t.JU)(l.db,"consultations",e.id);if(a.update(s,{status:"COMPLETED"}),e.queueId){let s=(0,t.JU)(l.db,"serviceQueue",e.queueId);a.update(s,{status:"Finalizado"})}await a.commit()},c=async e=>{if(!e)return null;let a=(0,t.JU)(l.db,"consultations",e);try{let e=await (0,t.QT)(a);return e.exists()?{id:e.id,...e.data()}:null}catch(e){throw Error("Falha ao carregar os dados da consulta.")}},n=async(e,a)=>{if(!e)throw Error("ID da consulta \xe9 obrigat\xf3rio.");let s=(0,t.JU)(l.db,"consultations",e);try{await (0,t.r7)(s,{clinicalEvolution:a.clinicalEvolution,diagnosticHypothesis:a.diagnosticHypothesis})}catch(e){throw Error("N\xe3o foi poss\xedvel salvar os dados do prontu\xe1rio.")}}}},function(e){e.O(0,[4358,9990,6137,9084,9733,7648,4517,2322,1106,2971,2117,1744],function(){return e(e.s=12017)}),_N_E=e.O()}]);