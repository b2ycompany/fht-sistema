(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1899],{12017:function(e,s,a){Promise.resolve().then(a.bind(a,59296))},59296:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return C}});var t=a(57437),l=a(2265),i=a(27648),r=a(99376),n=a(5978),c=a(17293);let o=async e=>{if(!e)return null;let s=(0,n.JU)(c.db,"consultations",e);try{let a=await (0,n.QT)(s);if(!a.exists())return console.warn("[getConsultationById] Nenhuma consulta encontrada com o ID: ".concat(e)),null;return{id:a.id,...a.data()}}catch(e){throw console.error("[getConsultationById] Erro ao buscar consulta:",e),Error("Falha ao carregar os dados da consulta.")}},d=async(e,s)=>{if(!e)throw Error("ID da consulta \xe9 obrigat\xf3rio.");let a=(0,n.JU)(c.db,"consultations",e);try{await (0,n.pl)(a,{clinicalEvolution:s.clinicalEvolution,diagnosticHypothesis:s.diagnosticHypothesis,status:"IN_PROGRESS"},{merge:!0})}catch(e){throw console.error("[saveConsultationDetails] Erro ao salvar detalhes da consulta:",e),Error("N\xe3o foi poss\xedvel salvar os dados do prontu\xe1rio.")}};var u=a(92651),x=a(46413),m=a(35153),f=a(51817),h=a(83229),p=a(76865),g=a(32660),v=a(23759),j=a(31047),N=a(91723),y=a(66070),b=a(62869),w=a(76818),S=a(26815),E=a(12339);let P=e=>{let{consultation:s,userProfile:a}=e,{toast:i}=(0,m.pm)(),[r,n]=(0,l.useState)((null==s?void 0:s.clinicalEvolution)||""),[c,o]=(0,l.useState)((null==s?void 0:s.diagnosticHypothesis)||""),[u,x]=(0,l.useState)(!1),p=async()=>{if(s){x(!0);try{await d(s.id,{clinicalEvolution:r,diagnosticHypothesis:c}),i({title:"Sucesso!",description:"Prontu\xe1rio salvo."})}catch(e){i({title:"Erro ao Salvar",description:e.message,variant:"destructive"})}finally{x(!1)}}};return s?(0,t.jsxs)(y.Zb,{className:"h-full flex flex-col",children:[(0,t.jsx)(y.Ol,{children:(0,t.jsx)(y.ll,{className:"text-lg",children:"Prontu\xe1rio Eletr\xf4nico"})}),(0,t.jsxs)(y.aY,{className:"flex-grow flex flex-col gap-4 overflow-y-auto",children:[(0,t.jsxs)(E.mQ,{defaultValue:"patient-data",className:"flex-grow flex flex-col",children:[(0,t.jsxs)(E.dr,{className:"grid w-full grid-cols-3",children:[(0,t.jsx)(E.SP,{value:"patient-data",children:"Paciente"}),(0,t.jsx)(E.SP,{value:"medical-record",children:"Atendimento"}),(0,t.jsx)(E.SP,{value:"documents",children:"Documentos"})]}),(0,t.jsxs)(E.nU,{value:"patient-data",className:"text-sm space-y-3 mt-4 flex-grow",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(S._,{className:"text-gray-500",children:"Nome"}),(0,t.jsx)("p",{children:s.patientName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(S._,{className:"text-gray-500",children:"Queixa Principal"}),(0,t.jsx)("p",{children:s.chiefComplaint})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(S._,{className:"text-gray-500",children:"Hist\xf3rico"}),(0,t.jsx)("p",{className:"whitespace-pre-wrap",children:s.medicalHistorySummary||"Nenhum hist\xf3rico informado."})]})]}),(0,t.jsxs)(E.nU,{value:"medical-record",className:"flex-grow flex flex-col gap-4 mt-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5 flex flex-col flex-grow",children:[(0,t.jsx)(S._,{htmlFor:"evolution",children:"Evolu\xe7\xe3o Cl\xednica"}),(0,t.jsx)(w.g,{id:"evolution",value:r,onChange:e=>n(e.target.value),className:"min-h-[150px] flex-grow"})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(S._,{htmlFor:"hypothesis",children:"Hip\xf3tese Diagn\xf3stica"}),(0,t.jsx)(w.g,{id:"hypothesis",value:c,onChange:e=>o(e.target.value)})]})]}),(0,t.jsx)(E.nU,{value:"documents",className:"mt-4 space-y-4",children:(0,t.jsx)("p",{className:"text-xs text-center text-gray-400",children:"A gera\xe7\xe3o de documentos (receitas, atestados, etc.) aparecer\xe1 aqui."})})]}),(0,t.jsx)("div",{className:"mt-auto pt-4",children:(0,t.jsxs)(b.z,{onClick:p,disabled:u,className:"w-full",children:[u?(0,t.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Salvar Prontu\xe1rio"]})})]})]}):(0,t.jsx)("div",{className:"p-4 text-sm text-center text-gray-500",children:"A carregar dados da consulta..."})};function C(){let e=(0,r.useParams)(),{user:s}=(0,x.a)(),a=e.consultaId,[n,c]=(0,l.useState)(null),[d,m]=(0,l.useState)(null),[h,w]=(0,l.useState)(!0),[S,E]=(0,l.useState)(null);return((0,l.useEffect)(()=>{a&&s&&(async()=>{w(!0);try{let[e,t]=await Promise.all([o(a),(0,u.Ts)()]);if(!e||e.doctorId!==s.uid)throw Error("Consulta n\xe3o encontrada ou acesso n\xe3o permitido.");c(e),m(t)}catch(e){E(e.message)}finally{w(!1)}})()},[a,s]),h)?(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)(f.Z,{className:"h-8 w-8 animate-spin"})}):S?(0,t.jsxs)("div",{className:"text-center text-red-600 p-8",children:[(0,t.jsx)(p.Z,{className:"mx-auto h-12 w-12 mb-4"}),(0,t.jsx)("p",{children:S})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(i.default,{href:"/dashboard/agenda",className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Voltar para a Agenda"]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 h-[calc(100vh-120px)]",children:[(0,t.jsx)("div",{className:"md:col-span-2 h-full",children:(0,t.jsx)(P,{consultation:n,userProfile:d})}),(0,t.jsx)("div",{className:"h-full",children:(0,t.jsxs)(y.Zb,{className:"h-full",children:[(0,t.jsx)(y.Ol,{children:(0,t.jsx)(y.ll,{children:"Detalhes do Atendimento"})}),(0,t.jsxs)(y.aY,{className:"space-y-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(v.Z,{className:"h-5 w-5 text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Local"}),(0,t.jsx)("p",{children:null==n?void 0:n.hospitalName})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(j.Z,{className:"h-5 w-5 text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Data"}),(0,t.jsx)("p",{children:null==n?void 0:n.createdAt.toDate().toLocaleDateString("pt-BR")})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(N.Z,{className:"h-5 w-5 text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Tipo de Atendimento"}),(0,t.jsx)("p",{children:null==n?void 0:n.serviceType})]})]}),(0,t.jsx)("div",{className:"mt-6 pt-4 border-t",children:(0,t.jsx)(b.z,{className:"w-full bg-green-600 hover:bg-green-700",children:"Finalizar Atendimento"})})]})]})})]})]})}},12339:function(e,s,a){"use strict";a.d(s,{SP:function(){return o},dr:function(){return c},mQ:function(){return n},nU:function(){return d}});var t=a(57437),l=a(2265),i=a(20271),r=a(94508);let n=i.fC,c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.aV,{ref:s,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...l})});c.displayName=i.aV.displayName;let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.xz,{ref:s,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...l})});o.displayName=i.xz.displayName;let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.VY,{ref:s,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});d.displayName=i.VY.displayName},76818:function(e,s,a){"use strict";a.d(s,{g:function(){return r}});var t=a(57437),l=a(2265),i=a(94508);let r=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});r.displayName="Textarea"}},function(e){e.O(0,[4358,9990,6137,9084,9733,7648,4517,106,5611,2971,2117,1744],function(){return e(e.s=12017)}),_N_E=e.O()}]);