(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{86430:function(e,a,t){Promise.resolve().then(t.bind(t,54692))},54692:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return E}});var s=t(57437),i=t(2265),r=t(66070),n=t(62869),l=t(99376),d=t(23759),c=t(51817),o=t(95805),u=t(99897),m=t(46413),h=t(35153),p=t(92651),x=t(33245),f=t(41671),N=t(76865),b=t(27648);let j=e=>{let{status:a,adminNotes:t,userType:i,editProfileLink:r}=e;return a?"PENDING_REVIEW"===a?(0,s.jsxs)("div",{className:"p-4 mb-6 text-sm text-blue-700 bg-blue-100 rounded-lg border border-blue-300",role:"alert",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,s.jsx)("span",{className:"font-medium",children:"Seu cadastro est\xe1 em an\xe1lise."})]}),(0,s.jsx)("p",{className:"mt-1.5 ml-8",children:"Avisaremos assim que o processo de verifica\xe7\xe3o for conclu\xeddo. Obrigado pela sua paci\xeancia!"})]}):"APPROVED"===a?(0,s.jsxs)("div",{className:"p-4 mb-6 text-sm text-green-700 bg-green-100 rounded-lg border border-green-300",role:"alert",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(f.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,s.jsx)("span",{className:"font-medium",children:"Seu cadastro foi aprovado!"})]}),(0,s.jsx)("p",{className:"mt-1.5 ml-8",children:"Voc\xea j\xe1 pode utilizar todas as funcionalidades da plataforma."})]}):"REJECTED_NEEDS_RESUBMISSION"===a?(0,s.jsxs)("div",{className:"p-4 mb-6 text-sm text-red-700 bg-red-100 rounded-lg border border-red-300",role:"alert",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(N.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,s.jsx)("span",{className:"font-medium",children:"Seu cadastro precisa de corre\xe7\xf5es."})]}),t&&(0,s.jsxs)("div",{className:"mt-2.5 ml-8",children:[(0,s.jsx)("strong",{className:"block mb-1",children:"Observa\xe7\xf5es do Administrador:"}),(0,s.jsx)("p",{className:"whitespace-pre-wrap bg-red-50 p-2 rounded border border-red-200",children:t})]}),(0,s.jsxs)("p",{className:"mt-2.5 ml-8",children:["Por favor, revise as informa\xe7\xf5es e/ou documentos solicitados e fa\xe7a as corre\xe7\xf5es necess\xe1rias.",(0,s.jsx)(b.default,{href:r||("doctor"===i?"/dashboard/profile/edit":"/hospital/profile/edit"),className:"ml-1 font-semibold text-red-800 hover:text-red-900 underline",children:"Clique aqui para corrigir seu cadastro."})]})]}):null:null};j.displayName="ProfileStatusAlert";var y=t(31623),v=t(18331),g=t(53647),w=t(26815);let k=e=>{let{title:a,description:t,attendanceType:o,icon:u}=e,{userProfile:x}=(0,m.a)(),f=(0,l.useRouter)(),{toast:N}=(0,h.pm)(),[b,j]=(0,i.useState)([]),[k,E]=(0,i.useState)(!0),[I,S]=(0,i.useState)(null),[Z,A]=(0,i.useState)([]),[P,U]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{if((null==x?void 0:x.healthUnitIds)&&x.healthUnitIds.length>0){let e=x.healthUnitIds.map(async e=>{let a=await (0,p.et)(e);return{id:e,name:(null==a?void 0:a.displayName)||"Unidade Desconhecida"}}),a=await Promise.all(e);A(a),a.length>0&&U(a[0].id)}})()},[x]),(0,i.useEffect)(()=>{if(P){E(!0);let e=(0,y.Yn)(P,"Aguardando Atendimento",o,e=>{j(e),E(!1)});return()=>e()}j([]),E(!1)},[P,o]);let C=async e=>{if(x){S(e.id);try{let a={uid:x.uid,displayName:x.displayName},t=await (0,v.hC)(e,a,e.hospitalName);f.push("/dashboard/atendimento/".concat(t))}catch(e){N({title:"Erro ao iniciar consulta",description:e.message,variant:"destructive"}),S(null)}}};return(0,s.jsxs)(r.Zb,{className:"flex flex-col",children:[(0,s.jsxs)(r.Ol,{children:[(0,s.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(u,{size:22})," ",a]}),(0,s.jsx)(r.SZ,{children:t})]}),(0,s.jsxs)(r.aY,{className:"flex-grow",children:[Z.length>1&&(0,s.jsxs)("div",{className:"mb-4 space-y-1.5",children:[(0,s.jsx)(w._,{htmlFor:"unit-selector-".concat(o),children:"A trabalhar na unidade:"}),(0,s.jsxs)(g.Ph,{value:null!=P?P:"",onValueChange:U,children:[(0,s.jsx)(g.i4,{id:"unit-selector-".concat(o),className:"w-full",children:(0,s.jsx)(g.ki,{placeholder:"Selecione a unidade..."})}),(0,s.jsx)(g.Bw,{children:Z.map(e=>(0,s.jsx)(g.Ql,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 text-muted-foreground"}),e.name]})},e.id))})]})]}),k?(0,s.jsx)("div",{className:"flex justify-center pt-8",children:(0,s.jsx)(c.Z,{className:"h-6 w-6 animate-spin"})}):b.length>0?(0,s.jsx)("div",{className:"space-y-2",children:b.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-md border border-blue-200",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-bold text-xl text-blue-800",children:e.ticketNumber}),(0,s.jsx)("p",{className:"text-sm font-semibold",children:e.patientName})]}),(0,s.jsx)(n.z,{size:"sm",onClick:()=>C(e),disabled:!!I,className:"bg-blue-600 hover:bg-blue-700",children:I===e.id?(0,s.jsx)(c.Z,{className:"h-4 w-4 animate-spin"}):"Iniciar Atendimento"})]},e.id))}):(0,s.jsx)("p",{className:"text-center text-sm text-muted-foreground pt-8",children:"Nenhum paciente na fila desta unidade no momento."})]})]})};function E(){let{user:e,userProfile:a,loading:t}=(0,m.a)(),[r,n]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{t||n(!1)},[t]),t||r)?(0,s.jsx)("div",{className:"p-6 flex justify-center items-center h-screen",children:(0,s.jsx)(c.Z,{className:"mx-auto h-10 w-10 animate-spin"})}):a?(0,s.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 space-y-8",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-800",children:["Bem-vindo(a) de volta, ",a.displayName,"!"]}),(0,s.jsx)(j,{status:a.documentVerificationStatus,userType:"doctor"}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsx)(k,{title:"Fila de Atendimento Presencial",description:"Pacientes na unidade que aguardam por si.",attendanceType:"Presencial",icon:o.Z}),(0,s.jsx)(k,{title:"Fila de Atendimento Telemedicina",description:"Pacientes aguardando uma consulta remota.",attendanceType:"Telemedicina",icon:u.Z})]})]}):(0,s.jsx)("div",{className:"p-6 text-center",children:"N\xe3o foi poss\xedvel carregar o perfil do utilizador."})}},18331:function(e,a,t){"use strict";t.d(a,{KO:function(){return o},Nb:function(){return c},hC:function(){return n},xr:function(){return d},yd:function(){return l}});var s=t(5978),i=t(17293);let r=(0,t(1850).V1)(i.wk,"createConsultationRoom"),n=async(e,a,t)=>{let n=(0,s.qs)(i.db),l=(0,s.JU)((0,s.hJ)(i.db,"consultations")),d={patientId:e.patientId,patientName:e.patientName,queueId:e.id,doctorId:a.uid,doctorName:a.displayName,hospitalId:e.unitId,hospitalName:e.hospitalName,status:"IN_PROGRESS",type:e.type,createdAt:(0,s.Bt)(),triageData:e.triageData||{},generatedDocuments:[]};if("Telemedicina"===e.type)try{let e=await r({consultationId:l.id});e.data.success&&(d.telemedicineLink=e.data.roomUrl)}catch(e){console.error("Falha ao criar a sala de telemedicina:",e)}n.set(l,d);let c=(0,s.JU)(i.db,"serviceQueue",e.id);return n.update(c,{status:"Em Atendimento",doctorId:a.uid}),await n.commit(),l.id},l=async e=>{let a=(0,s.qs)(i.db),t=(0,s.JU)(i.db,"consultations",e.id);if(a.update(t,{status:"COMPLETED"}),e.queueId){let t=(0,s.JU)(i.db,"serviceQueue",e.queueId);a.update(t,{status:"Finalizado"})}await a.commit()},d=async e=>{if(!e)return null;let a=(0,s.JU)(i.db,"consultations",e);try{let e=await (0,s.QT)(a);return e.exists()?{id:e.id,...e.data()}:null}catch(e){throw console.error("Falha ao carregar dados da consulta:",e),Error("Falha ao carregar os dados da consulta.")}},c=async e=>{let a=(0,s.hJ)(i.db,"consultations"),t=(0,s.IO)(a,(0,s.ar)("patientId","==",e),(0,s.Xo)("createdAt","desc"));return(await (0,s.PL)(t)).docs.map(e=>({id:e.id,...e.data()}))},o=async(e,a)=>{if(!e)throw Error("ID da consulta \xe9 obrigat\xf3rio.");let t=(0,s.JU)(i.db,"consultations",e);try{await (0,s.r7)(t,{clinicalEvolution:a.clinicalEvolution,diagnosticHypothesis:a.diagnosticHypothesis})}catch(e){throw console.error("Erro ao salvar dados do prontu\xe1rio:",e),Error("N\xe3o foi poss\xedvel salvar os dados do prontu\xe1rio.")}}},41671:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},33245:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},76865:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},95805:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(79205).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[3609,9015,6137,9388,5844,7648,266,4517,6008,9315,3073,2204,2971,2117,1744],function(){return e(e.s=86430)}),_N_E=e.O()}]);