(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{86430:function(e,t,a){Promise.resolve().then(a.bind(a,71720))},71720:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var r=a(57437),s=a(2265),n=a(66070),i=a(62869),o=a(99376),d=a(23759),l=a(51817),c=a(95805),u=a(99897),m=a(46413),f=a(35153),p=a(92651),h=a(37748),x=a(31623),N=a(18331),b=a(53647),g=a(26815);let y=e=>{let{title:t,description:a,attendanceType:c,icon:u}=e,{userProfile:h}=(0,m.a)(),y=(0,o.useRouter)(),{toast:v}=(0,f.pm)(),[j,w]=(0,s.useState)([]),[E,S]=(0,s.useState)(!0),[I,T]=(0,s.useState)(null),[_,A]=(0,s.useState)([]),[O,R]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{if((null==h?void 0:h.healthUnitIds)&&h.healthUnitIds.length>0){let e=h.healthUnitIds.map(async e=>{let t=await (0,p.et)(e);return{id:e,name:(null==t?void 0:t.displayName)||"Unidade Desconhecida"}}),t=await Promise.all(e);A(t),t.length>0&&R(t[0].id)}})()},[h]),(0,s.useEffect)(()=>{if(O){S(!0);let e=(0,x.Yn)(O,"Aguardando Atendimento",c,e=>{w(e),S(!1)});return()=>e()}w([]),S(!1)},[O,c]);let k=async e=>{if(h){T(e.id);try{let t={uid:h.uid,displayName:h.displayName},a=await (0,N.hC)(e,t,e.hospitalName);y.push("/dashboard/atendimento/".concat(a))}catch(e){v({title:"Erro ao iniciar consulta",description:e.message,variant:"destructive"}),T(null)}}};return(0,r.jsxs)(n.Zb,{className:"flex flex-col",children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(u,{size:22})," ",t]}),(0,r.jsx)(n.SZ,{children:a})]}),(0,r.jsxs)(n.aY,{className:"flex-grow",children:[_.length>1&&(0,r.jsxs)("div",{className:"mb-4 space-y-1.5",children:[(0,r.jsx)(g._,{htmlFor:"unit-selector-".concat(c),children:"A trabalhar na unidade:"}),(0,r.jsxs)(b.Ph,{value:null!=O?O:"",onValueChange:R,children:[(0,r.jsx)(b.i4,{id:"unit-selector-".concat(c),className:"w-full",children:(0,r.jsx)(b.ki,{placeholder:"Selecione a unidade..."})}),(0,r.jsx)(b.Bw,{children:_.map(e=>(0,r.jsx)(b.Ql,{value:e.id,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 text-muted-foreground"}),e.name]})},e.id))})]})]}),E?(0,r.jsx)("div",{className:"flex justify-center pt-8",children:(0,r.jsx)(l.Z,{className:"h-6 w-6 animate-spin"})}):j.length>0?(0,r.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-md border border-blue-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold text-xl text-blue-800",children:e.ticketNumber}),(0,r.jsx)("p",{className:"text-sm font-semibold",children:e.patientName})]}),(0,r.jsx)(i.z,{size:"sm",onClick:()=>k(e),disabled:!!I,className:"bg-blue-600 hover:bg-blue-700",children:I===e.id?(0,r.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}):"Iniciar Atendimento"})]},e.id))}):(0,r.jsx)("p",{className:"text-center text-sm text-muted-foreground pt-8",children:"Nenhum paciente na fila desta unidade no momento."})]})]})};function v(){let{user:e,userProfile:t,loading:a}=(0,m.a)(),[n,i]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{a||i(!1)},[a]),a||n)?(0,r.jsx)("div",{className:"p-6 flex justify-center items-center h-screen",children:(0,r.jsx)(l.Z,{className:"mx-auto h-10 w-10 animate-spin"})}):t?(0,r.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 space-y-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-800",children:["Bem-vindo(a) de volta, ",t.displayName,"!"]}),(0,r.jsx)(h.Z,{status:t.documentVerificationStatus,userType:"doctor"}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,r.jsx)(y,{title:"Fila de Atendimento Presencial",description:"Pacientes na unidade que aguardam por si.",attendanceType:"Presencial",icon:c.Z}),(0,r.jsx)(y,{title:"Fila de Atendimento Telemedicina",description:"Pacientes aguardando uma consulta remota.",attendanceType:"Telemedicina",icon:u.Z})]})]}):(0,r.jsx)("div",{className:"p-6 text-center",children:"N\xe3o foi poss\xedvel carregar o perfil do utilizador."})}},37748:function(e,t,a){"use strict";var r=a(57437);a(2265);var s=a(33245),n=a(41671),i=a(76865),o=a(27648);let d=e=>{let{status:t,adminNotes:a,userType:d,editProfileLink:l}=e;return t?"PENDING_REVIEW"===t?(0,r.jsxs)("div",{className:"p-4 mb-6 text-sm text-blue-700 bg-blue-100 rounded-lg border border-blue-300",role:"alert",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(s.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:"Seu cadastro est\xe1 em an\xe1lise."})]}),(0,r.jsx)("p",{className:"mt-1.5 ml-8",children:"Avisaremos assim que o processo de verifica\xe7\xe3o for conclu\xeddo. Obrigado pela sua paci\xeancia!"})]}):"APPROVED"===t?(0,r.jsxs)("div",{className:"p-4 mb-6 text-sm text-green-700 bg-green-100 rounded-lg border border-green-300",role:"alert",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(n.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:"Seu cadastro foi aprovado!"})]}),(0,r.jsx)("p",{className:"mt-1.5 ml-8",children:"Voc\xea j\xe1 pode utilizar todas as funcionalidades da plataforma."})]}):"REJECTED_NEEDS_RESUBMISSION"===t?(0,r.jsxs)("div",{className:"p-4 mb-6 text-sm text-red-700 bg-red-100 rounded-lg border border-red-300",role:"alert",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(i.Z,{className:"inline w-5 h-5 mr-3 shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:"Seu cadastro precisa de corre\xe7\xf5es."})]}),a&&(0,r.jsxs)("div",{className:"mt-2.5 ml-8",children:[(0,r.jsx)("strong",{className:"block mb-1",children:"Observa\xe7\xf5es do Administrador:"}),(0,r.jsx)("p",{className:"whitespace-pre-wrap bg-red-50 p-2 rounded border border-red-200",children:a})]}),(0,r.jsxs)("p",{className:"mt-2.5 ml-8",children:["Por favor, revise as informa\xe7\xf5es e/ou documentos solicitados e fa\xe7a as corre\xe7\xf5es necess\xe1rias.",(0,r.jsx)(o.default,{href:l||("doctor"===d?"/dashboard/profile/edit":"/hospital/profile/edit"),className:"ml-1 font-semibold text-red-800 hover:text-red-900 underline",children:"Clique aqui para corrigir seu cadastro."})]})]}):null:null};d.displayName="ProfileStatusAlert",t.Z=d},62869:function(e,t,a){"use strict";a.d(t,{d:function(){return d},z:function(){return l}});var r=a(57437),s=a(2265),n=a(37053),i=a(90535),o=a(94508);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:l=!1,...c}=e,u=l?n.g7:"button";return(0,r.jsx)(u,{className:(0,o.cn)(d({variant:s,size:i,className:a})),ref:t,...c})});l.displayName="Button"},66070:function(e,t,a){"use strict";a.d(t,{Ol:function(){return o},SZ:function(){return l},Zb:function(){return i},aY:function(){return c},eW:function(){return u},ll:function(){return d}});var r=a(57437),s=a(2265),n=a(94508);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});i.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});o.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});d.displayName="CardTitle";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});l.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},26815:function(e,t,a){"use strict";a.d(t,{_:function(){return l}});var r=a(57437),s=a(2265),n=a(6394),i=a(90535),o=a(94508);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.f,{ref:t,className:(0,o.cn)(d(),a),...s})});l.displayName=n.f.displayName},53647:function(e,t,a){"use strict";a.d(t,{Bw:function(){return h},Ph:function(){return c},Ql:function(){return x},i4:function(){return m},ki:function(){return u}});var r=a(57437),s=a(2265),n=a(56873),i=a(40875),o=a(22135),d=a(30401),l=a(94508);let c=n.fC;n.ZA;let u=n.B4,m=s.forwardRef((e,t)=>{let{className:a,children:s,...o}=e;return(0,r.jsxs)(n.xz,{ref:t,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...o,children:[s,(0,r.jsx)(n.JO,{asChild:!0,children:(0,r.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=n.xz.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.u_,{ref:t,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})});f.displayName=n.u_.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.$G,{ref:t,className:(0,l.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})});p.displayName=n.$G.displayName;let h=s.forwardRef((e,t)=>{let{className:a,children:s,position:i="popper",...o}=e;return(0,r.jsx)(n.h_,{children:(0,r.jsxs)(n.VY,{ref:t,className:(0,l.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...o,children:[(0,r.jsx)(f,{}),(0,r.jsx)(n.l_,{className:(0,l.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(p,{})]})})});h.displayName=n.VY.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.__,{ref:t,className:(0,l.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})}).displayName=n.__.displayName;let x=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,r.jsxs)(n.ck,{ref:t,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.wU,{children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(n.eT,{children:s})]})});x.displayName=n.ck.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(n.Z0,{ref:t,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=n.Z0.displayName},35153:function(e,t,a){"use strict";a.d(t,{pm:function(){return m}});var r=a(2265);let s=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],l={toasts:[]};function c(e){l=o(l,e),d.forEach(e=>{e(l)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(l);return r.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},18331:function(e,t,a){"use strict";a.d(t,{KO:function(){return c},Nb:function(){return l},hC:function(){return i},xr:function(){return d},yd:function(){return o}});var r=a(5978),s=a(17293);let n=(0,a(13491).V1)(s.wk,"createConsultationRoom"),i=async(e,t)=>{let a=(0,r.qs)(s.db),i=(0,r.JU)((0,r.hJ)(s.db,"consultations")),o={patientId:e.patientId,patientName:e.patientName,queueId:e.id,doctorId:t.uid,doctorName:t.displayName,hospitalId:e.unitId,hospitalName:e.hospitalName,status:"IN_PROGRESS",type:e.type,createdAt:(0,r.Bt)(),triageData:e.triageData||{},generatedDocuments:[]};if("Telemedicina"===e.type)try{let e=await n({consultationId:i.id});e.data.success&&(o.telemedicineLink=e.data.roomUrl)}catch(e){console.error("Falha ao criar a sala de telemedicina:",e)}a.set(i,o);let d=(0,r.JU)(s.db,"serviceQueue",e.id);return a.update(d,{status:"Em Atendimento",doctorId:t.uid}),await a.commit(),i.id},o=async e=>{let t=(0,r.qs)(s.db),a=(0,r.JU)(s.db,"consultations",e.id);if(t.update(a,{status:"COMPLETED"}),e.queueId){let a=(0,r.JU)(s.db,"serviceQueue",e.queueId);t.update(a,{status:"Finalizado"})}await t.commit()},d=async e=>{if(!e)return null;let t=(0,r.JU)(s.db,"consultations",e);try{let e=await (0,r.QT)(t);return e.exists()?{id:e.id,...e.data()}:null}catch(e){throw console.error("Falha ao carregar dados da consulta:",e),Error("Falha ao carregar os dados da consulta.")}},l=async e=>{let t=(0,r.hJ)(s.db,"consultations"),a=(0,r.IO)(t,(0,r.ar)("patientId","==",e),(0,r.Xo)("createdAt","desc"));return(await (0,r.PL)(a)).docs.map(e=>({id:e.id,...e.data()}))},c=async(e,t)=>{if(!e)throw Error("ID da consulta \xe9 obrigat\xf3rio.");let a=(0,r.JU)(s.db,"consultations",e);try{await (0,r.r7)(a,{clinicalEvolution:t.clinicalEvolution,diagnosticHypothesis:t.diagnosticHypothesis})}catch(e){throw console.error("Erro ao salvar dados do prontu\xe1rio:",e),Error("N\xe3o foi poss\xedvel salvar os dados do prontu\xe1rio.")}}},31623:function(e,t,a){"use strict";a.d(t,{E8:function(){return l},YR:function(){return u},Yn:function(){return d},Zw:function(){return c},bS:function(){return i},hK:function(){return n},xG:function(){return o}});var r=a(5978),s=a(17293);let n=async e=>{try{return(await (0,r.ET)((0,r.hJ)(s.db,"patients"),{...e,name_lowercase:e.name.toLowerCase(),createdAt:(0,r.Bt)()})).id}catch(e){throw console.error("Erro ao cadastrar paciente:",e),Error("N\xe3o foi poss\xedvel cadastrar o novo paciente.")}},i=async(e,t)=>{if(e.length<2)return[];try{let a=(0,r.hJ)(s.db,"patients"),n=e.toLowerCase(),i=(0,r.IO)(a,(0,r.ar)("unitId","==",t),(0,r.Xo)("name_lowercase"),(0,r.ar)("name_lowercase",">=",n),(0,r.ar)("name_lowercase","<=",n+""),(0,r.b9)(10));return(await (0,r.PL)(i)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Erro na busca por pacientes:",e),Error("N\xe3o foi poss\xedvel realizar a busca por pacientes.")}},o=async(e,t,a,n)=>{try{let i=(0,r.hJ)(s.db,"serviceQueue"),o=new Date;o.setHours(0,0,0,0);let d=(0,r.IO)(i,(0,r.ar)("unitId","==",t),(0,r.ar)("createdAt",">=",o)),l=await (0,r.PL)(d),c={ticketNumber:"".concat("Telemedicina"===n?"T":"A").concat((l.size+1).toString().padStart(3,"0")),patientName:e.name,patientId:e.id,status:"Aguardando Triagem",unitId:t,hospitalName:a,type:n,createdAt:(0,r.Bt)()};return(await (0,r.ET)(i,c)).id}catch(e){throw console.error("Erro ao adicionar paciente \xe0 fila:",e),Error("N\xe3o foi poss\xedvel adicionar o paciente \xe0 fila de atendimento.")}},d=(e,t,a,n)=>{let i=(0,r.IO)((0,r.hJ)(s.db,"serviceQueue"),(0,r.ar)("unitId","==",e),(0,r.ar)("status","==",t),(0,r.ar)("type","==",a),(0,r.Xo)("createdAt","asc"));return(0,r.cf)(i,e=>{n(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("[PatientService] Erro ao escutar a fila de atendimento:",e),n([])})},l=async(e,t)=>{try{await (0,r.r7)((0,r.JU)(s.db,"serviceQueue",e),{status:"Em Triagem",nurseId:t})}catch(e){throw Error("N\xe3o foi poss\xedvel chamar o paciente para a triagem.")}},c=async(e,t)=>{try{await (0,r.r7)((0,r.JU)(s.db,"serviceQueue",e),{triageData:t,status:"Aguardando Atendimento"})}catch(e){throw Error("N\xe3o foi poss\xedvel finalizar a triagem.")}},u=async e=>{if(!e)return null;let t=await (0,r.QT)((0,r.JU)(s.db,"patients",e));return t.exists()?{id:t.id,...t.data()}:null}}},function(e){e.O(0,[4358,9990,6137,9084,6838,7648,4517,6008,9315,1474,3073,2971,2117,1744],function(){return e(e.s=86430)}),_N_E=e.O()}]);