(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3557],{57526:function(e,a,s){Promise.resolve().then(s.bind(s,6789))},6789:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return I}});var t=s(57437),l=s(2265),r=s(27648),o=s(33145),i=s(62869),n=s(66070),c=s(95186),d=s(26815),m=s(32660),h=s(51817),x=s(31047),p=s(91723),u=s(29374),g=s(76865),j=s(95337),f=s(17662),b=s(96625),N=s(35153),v=s(99376),y=s(1850),w=s(17293),S=s(55773);let C=e=>{let{selectedSpecialty:a,onBack:s,onConfirm:r}=e,{toast:o}=(0,N.pm)(),[p,u]=(0,l.useState)({name:"",cpf:"",dob:"",phone:"",email:"",cep:"",street:"",number:"",neighborhood:"",city:"",state:""}),[g,j]=(0,l.useState)(!1),[f,b]=(0,l.useState)(!1),v=(0,y.V1)(w.wk,"users-findOrCreatePatient"),C=e=>{let{name:a,value:s}=e.target;u(e=>({...e,[a]:s}))},E=async e=>{let a=e.replace(/\D/g,"");if(8===a.length){b(!0);try{let e=await fetch("https://viacep.com.br/ws/".concat(a,"/json/"));if(!e.ok)throw Error("CEP n\xe3o encontrado");let s=await e.json();if(s.erro)throw Error("CEP n\xe3o encontrado");u(e=>({...e,street:s.logradouro,neighborhood:s.bairro,city:s.localidade,state:s.uf}))}catch(e){o({title:"Erro ao buscar CEP",description:e.message,variant:"destructive"})}finally{b(!1)}}},D=async e=>{if(e.preventDefault(),!p.email){o({title:"Email Obrigat\xf3rio",description:"O email \xe9 necess\xe1rio para o agendamento.",variant:"destructive"});return}j(!0);try{let e={...p,cpf:p.cpf.replace(/\D/g,""),phone:p.phone.replace(/\D/g,""),cep:p.cep.replace(/\D/g,"")},{patientId:a}=(await v(e)).data;if(!a)throw Error("N\xe3o foi poss\xedvel obter o ID do paciente.");r(p,a)}catch(e){console.error("Erro ao chamar findOrCreatePatient:",e),o({title:"Erro no Cadastro",description:e.message,variant:"destructive"}),j(!1)}};return(0,t.jsxs)("form",{onSubmit:D,className:"space-y-6 max-w-2xl mx-auto bg-white p-6 md:p-8 rounded-lg shadow-md border",children:[(0,t.jsxs)(i.z,{variant:"ghost",onClick:s,className:"mb-2 text-sm text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(m.Z,{className:"mr-2 h-4 w-4"})," Voltar para Especialidades"]}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-2",children:"Informa\xe7\xf5es do Paciente"}),(0,t.jsxs)("p",{className:"text-center text-muted-foreground mb-6",children:["Consulta para: ",(0,t.jsx)("span",{className:"font-semibold capitalize",children:a.toLowerCase()})]}),(0,t.jsxs)(n.Zb,{className:"p-4",children:[(0,t.jsx)(n.ll,{className:"text-lg mb-4",children:"Dados Pessoais"}),(0,t.jsxs)(n.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"name",children:"Nome Completo *"}),(0,t.jsx)(c.I,{id:"name",name:"name",value:p.name,onChange:C,required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"cpf",children:"CPF *"}),(0,t.jsx)(S.oc,{as:c.I,mask:"000.000.000-00",id:"cpf",name:"cpf",value:p.cpf,onAccept:e=>u(a=>({...a,cpf:e.toString()})),required:!0,placeholder:"000.000.000-00"})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"dob",children:"Data de Nascimento *"}),(0,t.jsx)(S.oc,{as:c.I,mask:"00/00/0000",id:"dob",name:"dob",value:p.dob,onAccept:e=>u(a=>({...a,dob:e.toString()})),required:!0,placeholder:"DD/MM/AAAA"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"phone",children:"Telefone (com DDD) *"}),(0,t.jsx)(S.oc,{as:c.I,mask:"[(00)] 00000-0000",id:"phone",name:"phone",value:p.phone,onAccept:e=>u(a=>({...a,phone:e.toString()})),required:!0,placeholder:"(11) 99999-9999"})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"email",children:"Email *"}),(0,t.jsx)(c.I,{id:"email",name:"email",type:"email",value:p.email,onChange:C,required:!0,placeholder:"email@exemplo.com"})]})]})]})]}),(0,t.jsxs)(n.Zb,{className:"p-4",children:[(0,t.jsx)(n.ll,{className:"text-lg mb-4",children:"Endere\xe7o"}),(0,t.jsxs)(n.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5 md:col-span-1",children:[(0,t.jsx)(d._,{htmlFor:"cep",children:"CEP *"}),(0,t.jsx)(S.oc,{as:c.I,mask:"00000-000",id:"cep",name:"cep",value:p.cep,onAccept:e=>u(a=>({...a,cep:e.toString()})),onBlur:e=>E(e.target.value),required:!0,placeholder:"00000-000"})]}),f&&(0,t.jsx)("div",{className:"md:col-span-2 flex items-end pb-2",children:(0,t.jsx)(h.Z,{className:"h-5 w-5 animate-spin"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5 md:col-span-2",children:[(0,t.jsx)(d._,{htmlFor:"street",children:"Rua *"}),(0,t.jsx)(c.I,{id:"street",name:"street",value:p.street,onChange:C,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-1.5 md:col-span-1",children:[(0,t.jsx)(d._,{htmlFor:"number",children:"N\xba *"}),(0,t.jsx)(c.I,{id:"number",name:"number",value:p.number,onChange:C,required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"neighborhood",children:"Bairro *"}),(0,t.jsx)(c.I,{id:"neighborhood",name:"neighborhood",value:p.neighborhood,onChange:C,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(d._,{htmlFor:"city",children:"Cidade *"}),(0,t.jsx)(c.I,{id:"city",name:"city",value:p.city,onChange:C,required:!0})]})]})]})]}),(0,t.jsxs)(i.z,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700",disabled:g||f,children:[g?(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),g?"A processar...":"Ver Hor\xe1rios Dispon\xedveis"]})]})},E=e=>{let{selectedSpecialty:a,patientData:s,onBack:r,onConfirm:o}=e,{toast:n}=(0,N.pm)(),[c,x]=(0,l.useState)(!0),[u,g]=(0,l.useState)([]),[j,f]=(0,l.useState)(null),[b,v]=(0,l.useState)(!1),S=(0,l.useCallback)((0,y.V1)(w.wk,"scheduling-getAvailableSlotsForSpecialty"),[]);return(0,l.useEffect)(()=>{(async()=>{x(!0);try{let{slots:e}=(await S({specialty:a})).data;g(e)}catch(e){console.error("Erro ao buscar hor\xe1rios:",e),n({title:"Erro ao Buscar Hor\xe1rios",description:e.message,variant:"destructive"}),e.message.includes("precisa de um \xedndice")&&n({title:"Aten\xe7\xe3o (Admin)",description:"Um \xedndice do Firestore \xe9 necess\xe1rio para buscar hor\xe1rios. Crie-o clicando no link no console do navegador (F12).",variant:"destructive",duration:1e4})}finally{x(!1)}})()},[a,n,S]),(0,t.jsxs)("div",{className:"space-y-4 max-w-lg mx-auto bg-white p-6 md:p-8 rounded-lg shadow-md border",children:[(0,t.jsxs)(i.z,{variant:"ghost",onClick:r,className:"mb-4 text-sm text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(m.Z,{className:"mr-2 h-4 w-4"})," Voltar para Dados do Paciente"]}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-2",children:"Escolha um Hor\xe1rio"}),(0,t.jsxs)("p",{className:"text-center text-muted-foreground mb-6",children:["Disponibilidade para ",(0,t.jsx)("span",{className:"font-semibold capitalize",children:a.toLowerCase()})]}),(0,t.jsxs)("p",{className:"text-center text-sm",children:["Paciente: ",s.name]}),c?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(h.Z,{className:"mx-auto h-8 w-8 animate-spin"})}):(0,t.jsxs)("div",{className:"space-y-3 max-h-64 overflow-y-auto pr-2",children:[(0,t.jsx)(d._,{children:"Pr\xf3ximos hor\xe1rios dispon\xedveis:"}),u.length>0?u.map(e=>{let a=new Date(e.date),s="".concat(a.toLocaleDateString("pt-BR")," das ").concat(e.startTime," \xe0s ").concat(e.endTime),l=(null==j?void 0:j.id)===e.id;return(0,t.jsxs)(i.z,{variant:l?"default":"outline",className:"w-full justify-start h-auto py-3",onClick:()=>f(e),children:[(0,t.jsx)(p.Z,{className:"mr-3 h-4 w-4"}),(0,t.jsxs)("div",{className:"flex flex-col items-start",children:[(0,t.jsx)("span",{className:"font-semibold",children:s}),(0,t.jsx)("span",{className:"text-xs font-normal",children:e.doctorName})]})]},e.id)}):(0,t.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"Nenhum hor\xe1rio de telemedicina encontrado para esta especialidade no momento."})]}),(0,t.jsx)(i.z,{onClick:()=>{if(!j)return;v(!0);let e=new Date("".concat(j.date.split("T")[0],"T").concat(j.startTime,":00"));setTimeout(()=>{o(j,e),v(!1)},500)},className:"w-full",disabled:!j||b,children:b?(0,t.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}):"Confirmar Agendamento"})]})},D=e=>{let{selectedSpecialty:a,patientData:s,selectedSlot:l,appointmentId:o,roomUrl:c,isLoading:d,error:m}=e,x=new Date(l.date),p="".concat(x.toLocaleDateString("pt-BR",{dateStyle:"long"})," das ").concat(l.startTime," \xe0s ").concat(l.endTime);return(0,t.jsxs)("div",{className:"space-y-4 max-w-lg mx-auto bg-white p-6 md:p-8 rounded-lg shadow-md border text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Agendamento"}),d&&(0,t.jsx)(h.Z,{className:"mx-auto h-10 w-10 animate-spin text-blue-600 mb-4"}),m&&(0,t.jsx)("p",{className:"text-red-600 bg-red-50 p-3 rounded border border-red-200",children:m}),o&&!m&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-green-600 font-semibold text-lg",children:"Consulta agendada com sucesso!"}),(0,t.jsxs)(n.Zb,{className:"text-left",children:[(0,t.jsx)(n.Ol,{children:(0,t.jsx)(n.ll,{className:"text-base",children:"Detalhes"})}),(0,t.jsxs)(n.aY,{className:"text-sm space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"Paciente:"})," ",s.name]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"Especialidade:"})," ",(0,t.jsx)("span",{className:"capitalize",children:a.toLowerCase()})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"M\xe9dico(a):"})," ",l.doctorName]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"font-semibold",children:"Data/Hora:"})," ",p]}),c&&(0,t.jsx)(i.z,{asChild:!0,className:"w-full mt-4 bg-green-600 hover:bg-green-700",children:(0,t.jsxs)("a",{href:c,target:"_blank",children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Entrar na Sala da Consulta"]})}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground pt-2",children:"Voc\xea receber\xe1 um lembrete por email."})]})]}),(0,t.jsxs)(r.default,{href:"/",children:[" ",(0,t.jsx)(i.z,{variant:"outline",children:"Voltar ao In\xedcio"})]})]})]})};function I(){let[e,a]=(0,l.useState)([]),[s,c]=(0,l.useState)(!0),[d,m]=(0,l.useState)(null),[x,p]=(0,l.useState)("selectSpecialty"),[u,S]=(0,l.useState)(""),[I,k]=(0,l.useState)(null),[T,Z]=(0,l.useState)(null),[F,A]=(0,l.useState)(null),[_,P]=(0,l.useState)(null),[z,q]=(0,l.useState)(!1),[B,V]=(0,l.useState)(null),[H,L]=(0,l.useState)(null),[O,Y]=(0,l.useState)(null),{toast:M}=(0,N.pm)();(0,v.useRouter)();let R=(0,y.V1)(w.wk,"scheduling-createAppointment");(0,l.useEffect)(()=>{(async()=>{c(!0),m(null);try{let e=await (0,b.e)();a(e)}catch(e){m(e.message||"N\xe3o foi poss\xedvel conectar ao servidor.")}finally{c(!1)}})()},[]);let U=e=>{var a;console.log("Especialidade Selecionada:",e),S(e),p("patientInfo"),window.scrollTo({top:(null===(a=document.getElementById("flow-section"))||void 0===a?void 0:a.offsetTop)||0,behavior:"smooth"})},G=async(e,a)=>{var s;if(A(e),P(a),p("confirm"),q(!0),V(null),L(null),Y(null),window.scrollTo({top:(null===(s=document.getElementById("flow-section"))||void 0===s?void 0:s.offsetTop)||0,behavior:"smooth"}),I&&T&&e)try{let s={patientName:I.name,patientId:T,doctorId:e.doctorId,doctorName:e.doctorName,specialty:u,appointmentDate:a.toISOString(),type:"Telemedicina"};console.log("Enviando payload para createAppointment:",s);let{appointmentId:t,roomUrl:l}=(await R(s)).data;if(!t)throw Error("ID do agendamento n\xe3o retornado pelo servidor.");L(t),Y(l||null),M({title:"Agendamento Confirmado!"})}catch(e){console.error("Erro ao criar agendamento:",e),V(e.message||"N\xe3o foi poss\xedvel concluir o agendamento."),M({title:"Erro no Agendamento",description:e.message,variant:"destructive"})}finally{q(!1)}else V("Dados do paciente, ID ou hor\xe1rio est\xe3o faltando."),q(!1)};return(0,t.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow-md sticky top-0 z-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[(0,t.jsx)(r.default,{href:"/",children:(0,t.jsx)(o.default,{src:f.Z,alt:"FHT Solu\xe7\xf5es Hospitalares",width:160,height:60})}),(0,t.jsxs)("nav",{className:"flex gap-4",children:[(0,t.jsx)(r.default,{href:"/login",children:(0,t.jsx)(i.z,{variant:"ghost",className:"text-blue-600 hover:text-blue-700",children:"Entrar"})}),(0,t.jsx)(r.default,{href:"/dashboard",children:(0,t.jsx)(i.z,{className:"bg-blue-600 hover:bg-blue-700 text-white px-6",children:"\xc1rea do M\xe9dico"})})]})]})}),(0,t.jsxs)("main",{className:"flex-1",children:[(0,t.jsx)("section",{className:"bg-gradient-to-r from-blue-100 via-white to-blue-50 py-20",children:(0,t.jsxs)("div",{className:"container mx-auto px-6 text-center",children:[(0,t.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 leading-tight mb-4",children:"Portal de Telemedicina FHT"}),(0,t.jsx)("p",{className:"text-lg text-gray-700 max-w-3xl mx-auto",children:"Cuidado e tecnologia ao seu alcance. Selecione a especialidade desejada para ver os pr\xf3ximos passos."})]})}),(0,t.jsx)("section",{id:"flow-section",className:"py-20 bg-white",children:(0,t.jsxs)("div",{className:"container mx-auto px-6",children:["selectSpecialty"===x&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-center text-gray-900 mb-12",children:"Nossas Especialidades Dispon\xedveis"}),s&&(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(h.Z,{className:"h-12 w-12 animate-spin text-blue-600"})}),d&&(0,t.jsxs)("div",{className:"text-center py-8 text-red-600 bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,t.jsx)(g.Z,{className:"mx-auto h-8 w-8 mb-2"}),(0,t.jsx)("p",{className:"font-semibold",children:"Erro ao carregar especialidades."}),(0,t.jsx)("p",{className:"text-sm",children:d})]}),!s&&!d&&(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.length>0?e.map(e=>(0,t.jsx)(n.Zb,{onClick:()=>U(e),className:"group hover:border-blue-600 hover:shadow-lg transition-all duration-300 cursor-pointer h-full",children:(0,t.jsxs)(n.aY,{className:"p-6 flex flex-col items-center text-center",children:[(0,t.jsx)("div",{className:"bg-blue-100 p-4 rounded-full mb-4 transition-colors duration-300 group-hover:bg-blue-600",children:(0,t.jsx)(j.Z,{className:"h-8 w-8 text-blue-600 transition-colors duration-300 group-hover:text-white"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 capitalize",children:e.toLowerCase()})]})},e)):(0,t.jsx)("p",{className:"col-span-full text-center text-muted-foreground",children:"Nenhuma especialidade dispon\xedvel."})})]}),"patientInfo"===x&&(0,t.jsx)(C,{selectedSpecialty:u,onBack:()=>{S(""),k(null),Z(null),A(null),P(null),p("selectSpecialty")},onConfirm:(e,a)=>{var s;k(e),Z(a),p("selectTime"),window.scrollTo({top:(null===(s=document.getElementById("flow-section"))||void 0===s?void 0:s.offsetTop)||0,behavior:"smooth"})}}),"selectTime"===x&&I&&(0,t.jsx)(E,{selectedSpecialty:u,patientData:I,onBack:()=>{A(null),P(null),p("patientInfo")},onConfirm:G}),"confirm"===x&&I&&F&&(0,t.jsx)(D,{selectedSpecialty:u,patientData:I,selectedSlot:F,appointmentId:H,roomUrl:O,isLoading:z,error:B})]})})]}),(0,t.jsx)("footer",{className:"bg-blue-700 text-white py-10 mt-auto",children:(0,t.jsx)("div",{className:"container mx-auto px-6 text-center",children:(0,t.jsxs)("p",{className:"text-sm",children:["\xa9 ",new Date().getFullYear()," FHT Solu\xe7\xf5es Hospitalares. Todos os direitos reservados."]})})})]})}},29374:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});let t=(0,s(79205).Z)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]])}},function(e){e.O(0,[3609,9015,6137,9388,7648,3145,7236,6372,2971,2117,1744],function(){return e(e.s=57526)}),_N_E=e.O()}]);